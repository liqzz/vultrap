id: CVE-2016-3978
info:
  name: Fortinet FortiOS  - Open Redirect/Cross-Site Scripting
  author: 0x_Akoko
  description: FortiOS Web User Interface in 5.0.x before 5.0.13, 5.2.x before 5.2.3,
    and 5.4.x before 5.4.0 allows remote attackers to redirect users to arbitrary
    web sites and conduct phishing attacks or cross-site scripting attacks via the
    "redirect" parameter to "login."
  severity: medium
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access, phishing attacks, and potential data theft.

    '
  remediation: 'Apply the latest security patches and updates provided by Fortinet
    to mitigate the vulnerability.

    '
  reference:
  - http://www.fortiguard.com/advisory/fortios-open-redirect-vulnerability
  - https://nvd.nist.gov/vuln/detail/CVE-2016-3978
  - http://seclists.org/fulldisclosure/2016/Mar/68
  - http://www.securitytracker.com/id/1035332
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2016-3978
    cwe-id: CWE-79
    epss-score: 0.00217
    epss-percentile: 0.59667
    cpe: cpe:2.3:o:fortinet:fortios:5.0.0:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: fortinet
    product: fortios
  tags: cve2016,cve,redirect,fortinet,fortios,seclists
traps:
- request:
    method: GET
    path: /login?redir=http://www.interact.sh
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\|\/\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$
    body: ''
