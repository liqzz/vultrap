id: CVE-2017-16894
info:
  name: Laravel <5.5.21 - Information Disclosure
  author: j4vaovo
  description: 'Laravel through 5.5.21 is susceptible to information disclosure. An
    attacker can obtain sensitive information such as externally usable passwords
    via a direct request for the /.env URI. NOTE: CVE pertains only to the writeNewEnvironmentFileWith
    function in src/Illuminate/Foundation/Console/KeyGenerateCommand.php, which uses
    file_put_contents without restricting .env permissions. The .env filename is not
    used exclusively by Laravel.

    '
  severity: high
  impact: 'An attacker can exploit this vulnerability to gain sensitive information
    from the application.

    '
  remediation: 'Upgrade Laravel to version 5.5.21 or higher to fix the information
    disclosure vulnerability.

    '
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16894
  - https://packetstormsecurity.com/files/cve/CVE-2017-16894
  - http://whiteboyz.xyz/laravel-env-file-vuln.html
  - https://twitter.com/finnwea/status/967709791442341888
  - https://nvd.nist.gov/vuln/detail/CVE-2017-16894
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2017-16894
    cwe-id: CWE-200
    epss-score: 0.11608
    epss-percentile: 0.95145
    cpe: cpe:2.3:a:laravel:laravel:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: laravel
    product: laravel
    shodan-query: Laravel-Framework
    fofa-query: app="Laravel-Framework"
  tags: cve,cve2017,laravel,exposure,packetstorm
traps:
- request:
    method: GET
    path: /.env
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: application/octet-stream
    body: APP_NAME=APP_DEBUG=DB_PASSWORD=
