id: CVE-2021-24849
info:
  name: WCFM WooCommerce Multivendor Marketplace < 3.4.12 - SQL Injection
  author: ritikchaddha
  description: 'The wcfm_ajax_controller AJAX action of the WCFM Marketplace WordPress
    plugin before 3.4.12, available to unauthenticated and authenticated user, does
    not properly sanitise multiple parameters before using them in SQL statements,
    leading to SQL injections.

    '
  severity: critical
  remediation: Fixed in 3.4.12
  reference:
  - https://wpscan.com/vulnerability/763c08a0-4b2b-4487-b91c-be6cc2b9322e/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24849
  - https://wordpress.org/plugins/wc-multivendor-marketplace/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24849
    cwe-id: CWE-89
    epss-score: 0.02367
    epss-percentile: 0.89583
    cpe: cpe:2.3:a:wclovers:frontend_manager_for_woocommerce_along_with_bookings_subscription_listings_compatible:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: wclovers
    product: frontend_manager_for_woocommerce_along_with_bookings_subscription_listings_compatible
    framework: wordpress
    publicwww-query: /wp-content/plugins/wc-multivendor-marketplace
  tags: wpscan,cve,cve2021,wp,wp-plugin,wordpress,wc-multivendor-marketplace,sqli
traps:
- request:
    method: GET
    path: /wp-content/plugins/wc-multivendor-marketplace/readme.txt
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: WCFM Marketplace - Best Multivendor Marketplace for WooCommerce
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: '{{post_data}}'
  response:
    status_code: 200
    headers: {}
    body: success
