id: CVE-2021-26084
info:
  name: Confluence Server - Remote Code Execution
  author: dhiyaneshDk,philippedelteil
  description: Confluence Server and Data Center contain an OGNL injection vulnerability
    that could allow an authenticated user, and in some instances an unauthenticated
    user, to execute arbitrary code on a Confluence Server or Data Center instance.
    The affected versions are before version 6.13.23, from version 6.14.0 before 7.4.11,
    from version 7.5.0 before 7.11.6, and from  version 7.12.0 before 7.12.5. The
    vulnerable endpoints can be accessed by a non-administrator user or unauthenticated
    user if 'Allow people to sign up to create their account' is enabled. To check
    whether this is enabled go to COG > User Management > User Signup Options.
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected server.

    '
  remediation: 'Apply the latest security patches provided by Atlassian to mitigate
    this vulnerability.

    '
  reference:
  - https://jira.atlassian.com/browse/CONFSERVER-67940
  - https://github.com/httpvoid/CVE-Reverse/tree/master/CVE-2021-26084
  - https://nvd.nist.gov/vuln/detail/CVE-2021-26084
  - https://github.com/Udyz/CVE-2021-26084
  - https://github.com/0xsyr0/OSCP
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-26084
    cwe-id: CWE-917
    epss-score: 0.97414
    epss-percentile: 0.99924
    cpe: cpe:2.3:a:atlassian:confluence_data_center:*:*:*:*:*:*:*:*
  metadata:
    max-request: 13
    vendor: atlassian
    product: confluence_data_center
    shodan-query: http.component:"Atlassian Confluence"
  tags: cve2021,cve,rce,confluence,injection,ognl,kev,atlassian
traps:
- request:
    method: POST
    path: /
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'queryString=aaaa\u0027%2b#{16*8787}%2b\u0027bbb

      '
  response:
    status_code: 200
    headers: {}
    body: value="aaaa{140592=null}
