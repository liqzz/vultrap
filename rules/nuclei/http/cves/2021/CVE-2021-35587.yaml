id: CVE-2021-35587
info:
  name: Oracle Access Manager - Remote Code Execution
  author: cckuailong
  description: 'The Oracle Access Manager  portion of Oracle Fusion Middleware (component:
    OpenSSO Agent) is vulnerable to remote code execution. Supported versions that
    are affected are 11.1.2.3.0, 12.2.1.3.0 and 12.2.1.4.0. This is an easily exploitable
    vulnerability that allows unauthenticated attackers with network access via HTTP
    to compromise Oracle Access Manager.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  remediation: 'Apply the latest security patches provided by Oracle to mitigate this
    vulnerability.

    '
  reference:
  - https://testbnull.medium.com/oracle-access-manager-pre-auth-rce-cve-2021-35587-analysis-1302a4542316
  - https://nvd.nist.gov/vuln/detail/CVE-2021-35587
  - https://www.oracle.com/security-alerts/cpujan2022.html
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-35587
    cwe-id: CWE-502
    epss-score: 0.95643
    epss-percentile: 0.99283
    cpe: cpe:2.3:a:oracle:access_manager:11.1.2.3.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: oracle
    product: access_manager
    shodan-query: http.title:"Oracle Access Management"
    fofa-query: body="/oam/pages/css/login_page.css"
  tags: cve2021,cve,oam,rce,java,unauth,oracle,kev
traps:
- request:
    method: GET
    path: /oam/server/opensso/sessionservice
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: x-oracle-dms-ecidx-oracle-dms-rid
    body: /oam/pages/css/general.css
