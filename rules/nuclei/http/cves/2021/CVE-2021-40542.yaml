id: CVE-2021-40542
info:
  name: Opensis-Classic 8.0 - Cross-Site Scripting
  author: alph4byt3
  description: 'Opensis-Classic Version 8.0 is affected by cross-site scripting. An
    unauthenticated user can inject and execute JavaScript code through the link_url
    parameter in Ajax_url_encode.php.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected application.

    '
  remediation: 'To mitigate this vulnerability, it is recommended to apply the latest
    security patches or updates provided by the vendor.

    '
  reference:
  - https://github.com/OS4ED/openSIS-Classic/issues/189
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40542
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-40542
    cwe-id: CWE-79
    epss-score: 0.00643
    epss-percentile: 0.78811
    cpe: cpe:2.3:a:os4ed:opensis:8.0:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: os4ed
    product: opensis
    shodan-query: http.title:"openSIS"
  tags: cve2021,cve,xss,opensis,os4ed
traps:
- request:
    method: GET
    path: /Ajax_url_encode.php?link_url=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>
