id: CVE-2021-44451
info:
  name: Apache Superset <=1.3.2 - Default Login
  author: dhiyaneshDK
  description: 'Apache Superset through 1.3.2 contains a default login vulnerability
    via registered database connections for authenticated users. An attacker can obtain
    access to user accounts and thereby obtain sensitive information, modify data,
    and/or execute unauthorized operations.

    '
  severity: medium
  impact: 'An attacker can gain unauthorized access to the Apache Superset application.

    '
  remediation: Upgrade to Apache Superset 1.4.0 or higher.
  reference:
  - https://github.com/detectify/ugly-duckling/blob/master/modules/crowdsourced/apache-superset-default-credentials.json
  - https://lists.apache.org/thread/xww1pccs2ckb5506wrf1v4lmxg198vkb
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44451
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-44451
    cwe-id: CWE-522
    epss-score: 0.00518
    epss-percentile: 0.74232
    cpe: cpe:2.3:a:apache:superset:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: apache
    product: superset
    shodan-query: http.favicon.hash:1582430156
  tags: cve2021,cve,apache,superset,default-login
traps:
- request:
    method: GET
    path: /login/
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /login/
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'csrf_token={{csrf_token}}&username={{username}}&password={{password}}

      '
  response:
    status_code: 200
    headers:
      VulTrap: session
    body: ''
- request:
    method: GET
    path: /dashboard/list/
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: DashboardFilterStateRestApi
