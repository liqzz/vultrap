id: CVE-2022-22733
info:
  name: Apache ShardingSphere ElasticJob-UI privilege escalation
  author: Zeyad Azima
  description: 'Exposure of Sensitive Information to an Unauthorized Actor vulnerability
    in Apache ShardingSphere ElasticJob-UI allows an attacker who has guest account
    to do privilege escalation. This issue affects Apache ShardingSphere ElasticJob-UI
    Apache ShardingSphere ElasticJob-UI 3.x version 3.0.0 and prior versions.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could result in unauthorized
    access and control of the ElasticJob-UI application.

    '
  remediation: 'Apply the latest security patches or updates provided by Apache ShardingSphere
    to mitigate the privilege escalation vulnerability.

    '
  reference:
  - https://www.vicarius.io/vsociety/blog/cve-2022-22733-apache-shardingsphere-elasticjob-ui-privilege-escalation
  - https://nvd.nist.gov/vuln/detail/CVE-2022-22733
  - https://lists.apache.org/thread/qpdsm936n9bhksb0rzn6bq1h7ord2nm6
  - http://www.openwall.com/lists/oss-security/2022/01/20/2
  - https://github.com/Zeyad-Azima/CVE-2022-22733
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2022-22733
    cwe-id: CWE-200
    epss-score: 0.12656
    epss-percentile: 0.95328
    cpe: cpe:2.3:a:apache:shardingsphere_elasticjob-ui:3.0.0:-:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: apache
    product: shardingsphere_elasticjob-ui
    shodan-query: http.favicon.hash:816588900
  tags: cve2022,cve,exposure,sharingsphere,apache
traps:
- request:
    method: POST
    path: /api/login
    headers:
      Accept: application/json, text/plain, */*
      Access-Token: ''
      Content-Type: application/json;charset=UTF-8
      Origin: '{{RootURL}}'
      Referer: '{{RootURL}}'
    body: '{"username":"guest","password":"guest"}

      '
  response:
    status_code: 200
    headers: {}
    body: '"success":true"isGuest":true"accessToken":'
