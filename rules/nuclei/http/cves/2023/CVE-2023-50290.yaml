id: CVE-2023-50290
info:
  name: Apache Solr - Host Environment Variables Leak via Metrics API
  author: Banana69,DhiyaneshDK
  description: |
    Exposure of Sensitive Information to an Unauthorized Actor Vulnerability in Apache Solr.
    The Solr Metrics API publishes all unprotected environment variables available to each Apache Solr instance. Users can specify which environment variables to hide, however, the default list is designed to work for known secret Java system properties. Environment variables cannot be strictly defined in Solr, like Java system properties can be, and may be set for the entire host,unlike Java system properties which are set per-Java-proccess.
  severity: medium
  impact: 'This vulnerability can lead to the exposure of sensitive information, potentially
    allowing an attacker to gain unauthorized access or perform further attacks.

    '
  remediation: Users are recommended to upgrade to version 9.3.0 or later, in which
    environment variables are not published via the Metrics API.
  reference:
  - https://solr.apache.org/security.html#cve-2023-50290-apache-solr-allows-read-access-to-host-environment-variables
  - https://x.com/sirifu4k1/status/1746755165066236216?s=20
  - https://nvd.nist.gov/vuln/detail/CVE-2023-50290
  - https://github.com/wy876/POC
  - https://github.com/wy876/wiki
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2023-50290
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-score: 0.05452
    epss-percentile: 0.92995
    cpe: cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: apache
    product: solr
    shodan-query: title:"Apache Solr"
  tags: cve,cve2023,apache,solr,exposure
traps:
- request:
    method: GET
    path: /solr/admin/metrics
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: application/json
    body: '"responseHeader":"solr.jetty":system.env'
