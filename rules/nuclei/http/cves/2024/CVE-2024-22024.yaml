id: CVE-2024-22024
info:
  name: Ivanti Connect Secure - XXE
  author: watchTowr
  description: 'Ivanti Connect Secure is vulnerable to XXE (XML External Entity) injection.

    '
  severity: high
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access to sensitive information or remote code execution.

    '
  remediation: 'Apply the latest security patches or updates provided by Ivanti to
    fix the XXE vulnerability.

    '
  reference:
  - https://labs.watchtowr.com/are-we-now-part-of-ivanti/
  - https://twitter.com/h4x0r_dz/status/1755849867149103106/photo/1
  metadata:
    max-request: 1
    vendor: ivanti
    product: connect_secure
    shodan-query: html:"welcome.cgi?p=logo"
  tags: cve,cve2024,kev,xxe,ivanti
traps:
- request:
    method: POST
    path: /dana-na/auth/saml-sso.cgi
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: 'SAMLRequest={{base64(payload)}}

      '
  response:
    status_code: 200
    headers: {}
    body: /dana-na/WriteCSS
