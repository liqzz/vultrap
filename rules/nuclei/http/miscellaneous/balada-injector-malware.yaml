id: balada-injector-malware
info:
  name: Balada Injector Malware - Detect
  author: kazet
  description: 'Checks websites for Balada Injector malware.

    '
  severity: high
  reference:
  - https://blog.sucuri.net/2024/01/thousands-of-sites-with-popup-builder-compromised-by-balada-injector.html
  metadata:
    max-request: 1
  tags: malware,balada,misc
traps:
- request:
    method: GET
    path: ''
    headers: null
    body: null
  response:
    status_code: 200
    headers:
      VulTrap: text/html
    body: (?mi)sgpbWillOpen", *function\(e\) *{if *\(e[.]detail[.]popupId.{0,100}eval.{0,100}atob
